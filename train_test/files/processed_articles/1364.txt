{
    "abstract": "Wednesday, October 11th, 2006, Professor T. J. Sweeting in the Chair]",
    "reduced_content": "University of Washington, Seattle, USA\nand Jeremy M. Tantrum\nMicrosoft adCenter Labs, Redmond, USA\n[Read before The Royal Statistical Society at a meeting organized by the Research Section on\nWednesday, October 11th, 2006, Professor T. J. Sweeting in the Chair]\nSummary. Network models are widely used to represent relations between interacting units or\nactors. Network data often exhibit transitivity, meaning that two actors that have ties to a third\nactor are more likely to be tied than actors that do not, homophily by attributes of the actors\nor dyads, and clustering. Interest often focuses on finding clusters of actors or ties, and the\nnumber of groups in the data is typically unknown.We propose a new model, the latent position\ncluster model, under which the probability of a tie between two actors depends on the distance\nbetween them in an unobserved Euclidean `social space', and the actors' locations in the latent\nsocial space arise from a mixture of distributions, each corresponding to a cluster. We propose\ntwo estimation methods: a two-stage maximum likelihood method and a fully Bayesian method\nthat uses Markov chain Monte Carlo sampling. The former is quicker and simpler, but the latter\nperforms better. We also propose a Bayesian way of determining the number of clusters that\nare present by using approximate conditional Bayes factors. Our model represents transitivity,\nhomophily by attributes and clustering simultaneously and does not require the number of clus-\nters to be known. The model makes it easy to simulate realistic networks with clustering, which\nare potentially useful as inputs to models of more complex systems of which the network is part,\nsuch as epidemic models of infectious disease. We apply the model to two networks of social\nrelations. A free software package in the R statistical language, latentnet, is available to analyse\ndata by using the model.\nKeywords: Bayes factor; Dyad; Latent space; Markov chain Monte Carlo methods; Mixture\nmodel; Transitivity\n1. Introduction\nNetworks are widely used to represent data on relations between interacting actors or nodes.\nThey can be used to describe the behaviour of epidemics, the interconnectedness of corporate\nboards, networks of genetic regulatory interactions and computer networks, among others.\nIn social networks, each actor represents a person or social group, and each link, tie or arc\nrepresents the presence or strength of a relationship between two actors. Nodes can be used\nto represent larger social units (groups, families or organizations), objects (airports, servers or\nlocations) or abstract entities (concepts, texts, tasks or random variables).\nSocial network data typically consist of a set of n actors and a relational tie yi,j, measured on\neach ordered pair of actors i,j =1,. . . , n. In the simplest cases, yi,j is a dichotomous variable,\nindicating the presence or absence of a relation of interest, such as friendship, collaboration or\ntransmission of information or disease. The data are often represented by an n\u00d7n sociomatrix\nAddress for correspondence: Adrian E. Raftery, Center for Statistics and the Social Sciences, University of\nE-mail: raftery@u.washington.edu\n302 M. S. Handcock, A. E. Raftery and J. M. Tantrum\nY. In the case of binary relations, the data can also be thought of as a graph in which the nodes\nare actors and the (directed) edges are {.i,j/:yi,j\n=1}. When .i,j/ is an edge we write ij.\nA feature of most social networks is transitivity of relations whereby two actors that have\nties to a third actor are more likely to be tied than actors that do not. Transitivity has been\nextensively studied both empirically and theoretically (White et al., 1976). Transitivity can lead\nto some clustering of relationships within the network.\nThe likelihood of a tie usually depends on attributes of the actors. For example, for most\nsocial relations the likelihood of a relationship is a function of the age, gender, geography, race\nand status of the individuals. In addition, ties are often more likely to occur between actors that\nhave similar attributes than between those who do not, a tendency that we call homophily by\nhomophily by attributes usually implies increased probability of a tie, the effect may be reversed\n(e.g. gender and sexual relationships).\nMany social networks exhibit clustering beyond what can be explained by transitivity and\nhomophily on observed attributes. This can be driven by homophily on unobserved attributes\nor on endogenous attributes such as position in the network (Wasserman and Faust, 1994),\n`self-organization' into groups or a preference for popular actors. Often the key questions in\na social network analysis revolve around the identification of clusters, but conclusions about\nclustering are usually drawn by informal visual examinations of the network rather than by\nmore formal inference methods (Liotta, 2004).\nExisting stochastic models struggle to represent the three common features of social networks\nthat we have mentioned, namely transitivity, homophily by attributes and clustering. Holland\nand Leinhardt (1981) proposed a model in which each dyad--by which we mean each pair of\nactors--had ties independently of every other dyad. This model was inadequate because it did\nnot capture any of the three characteristics. Frank and Strauss (1986) generalized it to the case\nin which dyads exhibit a form of Markovian dependence: two dyads are dependent, conditional\non the rest of the graph, only when they share an actor. This can represent transitivity, although\nnot the other two characteristics. Exponential random graph models generalize this idea further\nand can represent some forms of transitivity (Snijders et al., 2006).\nModels based only on the distribution of the number of edges linking to the actors, or degree\ndistribution, are popular in physics and applied mathematics; for a review see Newman (2003).\nThese are also quite restrictive and often do not model any of the three key features of network\ndata that we have mentioned (Snijders, 1991).\nThe seminal work on structural equivalence by Lorrain and White (1971) motivated statis-\ntical procedures for clustering or `blocking' relational data (blockmodels). Blocking consists of\na known prespecified partition of the actors into discrete blocks and, for each pair of blocks, a\nstatement of the presence or absence of a tie within or between the blocks. This requires knowl-\nedge of the partition, which will often not be available. Breiger et al. (1975) and White et al.\n(1976) developed and compared alternative algorithms. Subsequent work in this area has been\non deterministic algorithms to block actors into prespecified theoretical types (Doreian et al.,\n2005). Here we focus on stochastic models for networks, which seem more appropriate for many\napplications.\nFienberg and Wasserman (1981) developed a probabilistic model for structural equivalence\nof actors in a network, under which the probabilities of relationships with all other actors are\nthe same for all actors in the same class. This can be viewed as a stochastic version of a block\nmodel. It can represent clustering, but only when the cluster memberships are known. Wass-\nerman and Anderson (1987) and Snijders and Nowicki (1997) extended these models to latent\nclasses; the difference is that these latent class models do not assume cluster memberships to\nClustering for Social Networks 303\nbe known, but instead estimate them from the data. Nowicki and Snijders (2001) presented\na model where the number of classes is arbitrary and unknown. The model assumes that the\nprobability distribution of the relation between two actors depends only on the latent classes to\nwhich the two actors belong and the relations are independent conditionally on these classes.\nThese models do capture some kinds of clustering, but they do not represent transitivity within\nclusters or homophily on attributes. Tallberg (2005) extended this model to represent homophily\non observed attributes.\nThe idea of representing a social network by assigning positions in a continuous space to the\nand Breiger et al. (1975), who used multidimensional scaling to do this, and this approach has\nbeen widely used since (Wasserman and Faust, 1994). A strength of this approach is that it takes\naccount of transitivity automatically and in a natural way. A disadvantage is that a dissimilar-\nity measure must be supplied to the algorithm for each dyad, and many different dissimilarity\nmeasures are possible, so the results depend on a choice for which there is no clear theoretical\nguidance.\nThe latent space model of Hoff et al. (2002) is a stochastic model of the network in which\neach actor has a latent position in a Euclidean space, and the latent positions are estimated by\nusing standard statistical principles; thus no arbitrary choice of dissimilarity is required. This\nmodel automatically represents transitivity and can also take account of homophily on observed\nattributes in a natural way. This approach was applied to international relations networks by\nHoff and Ward (2004) and was extended to include random actor-specific effects by Hoff (2005).\nA similar model was proposed by Schweinberger and Snijders (2003), but using an ultrametric\nspace rather than a Euclidean space.\nHere we propose a new model, the latent position cluster model, that takes account of tran-\nsitivity, homophily on attributes and clustering simultaneously in a natural way. It extends the\nlatent space model of Hoff et al. (2002) to take account of clustering, using the ideas of model-\nbased clustering (Fraley and Raftery, 2002). The resulting model can be viewed as a stochastic\nblockmodel with transitivity within blocks and homophily on attributes. It can also be viewed\nas a generalization of latent class models to allow heterogeneity of structure within the classes.\nIn Section 2 we describe the latent position cluster model. In Section 3 we give two differ-\nent ways of estimating it. One is a two-stage maximum likelihood estimation method, which is\nrelatively fast and simple. The other is a fully Bayesian method that uses Markov chain Monte\nCarlo (MCMC) sampling; this is more complicated but performs better in our examples. In\nSection 4 we propose a Bayesian approach to choosing the number of groups in the data by\nusing approximate conditional Bayes factors. In Section 5 we illustrate the method by using two\nsocial network data sets.\n2. The latent position cluster model for social networks\nThe data that we model consist of an n\u00d7n sociomatrix Y, with entries yi,j denoting the value\nof the relation from actor i to actor j, possibly in addition to covariate information X={Xi,j\n}.\nWe focus on binary-valued relations, although the methods in this paper can be extended to\nmore general relational data. Both directed and undirected relations can be analysed with our\nmethods, although the models are slightly different in the two cases.\nWe assume that each actor has an unobserved position in a d-dimensional Euclidean latent\nsocial space, as in Hoff et al. (2002). We then assume that the presence or absence of a tie between\ntwo individuals is independent of all other ties, given the positions Z = {zi\n} in social space of\nthe two individuals. Thus\n304 M. S. Handcock, A. E. Raftery and J. M. Tantrum\nP.Y|Z,X,/=\ni=j\nP.yi,j\n|zi, zj, xi,j, /, .1/\nwhere X={xi,j\n} denotes observed characteristics that may be dyad specific and vector valued,\nand  denotes parameters to be estimated. We model P.yi,j\n|zi, zj, xi,j, / by using a logistic\nregression model in which the probability of a tie depends on the Euclidean distance between\nzi and zj in social space:\nlog-odds.yi,j\n=1|zi,zj,xi,j,/=T\nxi,j\n|zi\n-zj\nwhere the log-odds of an event A is log-odds.A/=log[P.A/={1-P.A/}]. The model accounts\nfor transitivity, through the latent space, as well as homophily on the observed attributes X. To\nidentify the scale of the positions and 0 and 1, we restrict the positions to have unit root mean\nsquare:\nn i\n|zi\nTo represent clustering, we assume that the zis are drawn from a finite mixture of G multi-\nvariate normal distributions, each representing a different group of actors. Each multivariate\nnormal distribution has a different mean vector, and a spherical covariance matrix, with var-\niances that differ between groups. Thus\nzi\n\nG\ng MVNd.g, 2\ng\nwhere g is the probability that an actor belongs to the gth group, so that g 0.g =1, . . . ,G/\nand G\ng =1, and Id is the d \u00d7d identity matrix. The choice of spherical covariance matrices\nis motivated by the fact that the likelihood is invariant to rotations of the latent social space, so\nit seems reasonable that the model be specified independently of the co-ordinate system. Model\n(3) was proposed as a model for clustering of observed variables by Banfield and Raftery (1993).\n3. Estimation\nWe propose two different estimation methods for the latent position cluster model. The first is\na two-stage method that first computes the maximum likelihood estimator of the (non-cluster-\ning) latent space model, and then computes the maximum likelihood estimator for the mixture\nmodel applied to the resulting estimated latent positions. This is fast and relatively simple, but\nit does not take advantage of the clustering information when estimating the latent positions.\nThe second method is fully Bayesian and uses MCMC sampling; it estimates the latent posi-\ntions and the clustering model simultaneously. This is more demanding computationally and\nalgebraically than the first method, but it performs better in our examples.\n3.1. Two-stage maximum likelihood estimation\nThe first stage is to carry out maximum likelihood estimation of the latent positions for the (non-\nclustering) latent space model of Hoff et al. (2002), as described there. This is fairly straightfor-\nward because the log-likelihood is convex as a function of the distances between actors, although\nnot as a function of the actors' positions. One can thus rapidly find estimates of the distances,\nand then find a set of latent positions that approximate them by multidimensional scaling. This\ngives a good starting-point for a non-linear optimization method.\nClustering for Social Networks 305\nThe second stage is to find a maximum likelihood estimator of the mixture model condition-\nally on the latent positions that are estimated at the first stage. This can be done by using the EM\nalgorithm (Dempster et al., 1977). It has been implemented for model (3) in a clustering context\nmodel (3) does not have a unique local maximum, and the local maximum that is found by the\nEM algorithm can depend on the starting values. Here we use starting values from hierarchical\nmodel-based clustering (Banfield and Raftery, 1993).\nThis estimation method is fast and simple, and yields a close match between the estimated\nlatent positions and cluster memberships. However, by not estimating the latent positions and\nthe cluster model at the same time, we lose information from the cluster structure that may be\nuseful in estimating the latent positions, and we lose information on the uncertainty about the\nlatent positions that can be useful in clustering. We now describe a simultaneous estimation\nmethod that does not have these disadvantages.\n3.2. Bayesian estimation\nOur second method consists of fully Bayesian estimation of the latent position cluster model\ngiven by equations (1)\u00ad(3), using MCMC sampling. We introduce the new variables Ki, equal\nto g if the ith actor belongs to the gth group, as is standard in Bayesian estimation of mixture\nmodels (e.g. Diebolt and Robert (1994)).\nWe specify prior distributions for the parameters  =.T\ng\nand g,\nas follows:\n MVNp.,/,\nDirichlet./,\ng\nIID\n\n, g =1, . . . ,G,\ng\nIID\nwhere , ,  =.1, . . . , G/, 2\n,  and  are hyperparameters to be specified by the user.\nWe set g =3, which puts low probability on small group sizes, and  =0 and =2I, which\nallow a wide range of values of . We take  = 2 and 2\n-distribution), which implies a prior density on 2\ng\nand 1, corresponding to groups whose standard deviation can be as small as 13% of the average\nradius of the data. Finally, we specify 2 =2, which ensures that the prior density of the means\nis relatively flat over the range of the data.\nOur MCMC algorithm iterates over the model parameters with the priors given above, the\nlatent positions zi and the group memberships Ki. Where possible we sample from the full con-\nditional posterior distributions as in Gibbs sampling; otherwise we use Metropolis\u00adHastings\nsteps. Let `others' denote those of the parameters, latent positions and group memberships that\nare not explicitly specified in the following formulae. The full conditional posterior distributions\nare\nzi\n|Ki\n=g, othersd.zi;g,2\ng\nId/ P.Y|Z,X,/, i=1, . . . ,n, .4/\n|Z, othersp.;,/ P.Y|Z, X,/, .5/\n|othersDirichlet.m+/, .6/\n306 M. S. Handcock, A. E. Raftery and J. M. Tantrum\ng|othersMVNd\nmg \u00af\nzg\ng\n,\ng\ng\nI , g =1, . . . ,G, .7/\ng\ng\n+mgd\n, g =1, . . . ,G, .8/\nP.Ki\n=g|others/=\ng d.zi;g,2\ng\nId/\nG\nr\nr\nId/\n, i=1, . . . ,n, g =1, . . . ,G, .9/\nwhere\nmg =\nn\nI[Ki=g],\ng\n=\nd\nn\n.zi\n-g/T.zi\n-g/I[Ki=g],\n\u00af\nzg =\nmg\nn\nziI[Ki=g],\nand d.\u00b7;,/ is the d-dimensional multivariate normal density.\nOur algorithm is then as follows.\nStep 1: use Metropolis\u00adHastings steps to sample Zt+1, updating each actor in random order.\n(a) Propose Z\u00c5\ni\nMVNd.Zit,2\nZ\nId/.\n(b) With probability equal to\nP.Y|Z\u00c5,X,t/ d.Z\u00c5\ni\n;Ki\nKi\nId/\nP.Y|Zt,X,t/ d.Zit;Ki\nKi\nId/\n,\nset the ith element of Zt+1 to Z\u00c5\ni\n. Otherwise set it to Zit.\nStep 2: use Metropolis\u00adHastings steps to sample t+1.\n(a) Propose \u00c5 MVNd.t,2\n\nIp/.\n(b) With probability equal to\nP.Y|Zt+1,X,\u00c5/ p.\u00c5;, /\nP.Y|Zt+1,X,t/ p.t;, /\n,\n=\u00c5. Otherwise set t+1\n=t.\nStep 3: update Ki, g, 2\ng\nand g from expressions (6)\u00ad(9).\nThe proposal distribution variance parameters, Z and , are set by the user to achieve good\nperformance of the algorithm. On the basis of some experimentation, we used Z\n3.3. Identifiability of positions and cluster labels\nAs the likelihood is a function of the latent positions only through their distances, it is invariant\nto reflections, rotations and translations of the latent positions. The likelihood is also invariant\nClustering for Social Networks 307\nto relabelling of the clusters, in the sense that permuting the cluster labels does not change the\nlikelihood. This is often referred to as the label switching problem (Stephens, 2000).\nWe resolve these non-identifiabilities (or near non-identifiabilities in the Bayesian context)\nby post-processing the MCMC output. One simple two-stage approach to this would be as\nfollows. First carry out a Procrustes transformation (Sibson, 1979) of each posterior draw of\nthe latent positions to resolve the invariance to reflections, rotations and translations, following\nOh and Raftery (2001) and Hoff et al. (2002). The target configuration would be the positions\nthat are produced by the two-stage maximum likelihood procedure. Second, use the relabelling\nalgorithm of Celeux et al. (2000) to solve the label switching problem.\nInstead, however, we adopt a framework that is aimed at minimizing the Bayes risk relative\nto a Kullback\u00adLeibler loss. The main idea is to find a configuration with distribution that is\nclose to the corresponding `true' distribution in terms of Bayes risk. To do this, we post-process\nthe MCMC sample as follows.\n(a) Find the positions of the actors that minimize the estimated Bayes risk among all posi-\ntions.\n(b) Procrustes transform the posterior draws of latent positions and, using the same trans-\nformation matrix, transform the cluster means and covariances.\n(c) Find the cluster membership probabilities of the actors that minimize the estimated Bayes\nrisk among all permutations of the cluster labels.\nThe general approach is due to Stephens (2000), and step (c) closely follows his solution to the\nlabel switching problem. The technical details of the steps are given in Appendix A.\n4. Choosing the number of clusters\nWe recast the problem of choosing the number of clusters as one of model selection. Each num-\nber of clusters corresponds to a different statistical model, and we develop a Bayesian approach\nto comparing the resulting models.\nOne simple approach to model selection for the latent position cluster model is based on the\ntwo-stage maximum likelihood estimation method of Section 3.1. We first compute the maxi-\nmum likelihood estimates of the latent positions by using the latent space model of Hoff et al.\n(2002). We then carry out model-based clustering of the resulting estimated latent positions,\ncomputing the Bayes information criterion (BIC) for each different number of groups, and\nchoosing the number of groups with the highest values of the BIC, as described by Dasgupta\nand Raftery (1998) and Fraley and Raftery (2002). As we shall see, however, this does not per-\nform well, and instead we develop an approach that is based on the fully Bayesian estimation\nmethod of Section 3.2.\nThe standard Bayesian approach to model selection is to compute the posterior model prob-\nability of each of the competing models (Kass and Raftery, 1995). If we want to select a single\nmodel, we select the model with the highest posterior probability. The posterior model probabil-\nity is proportional to the integrated likelihood for the model times the prior model probability.\nThe integrated likelihood is obtained by integrating the likelihood times the prior over the\nmodel's parameter space. We assign equal prior probabilities to the models that we consider.\nHere we use conditional posterior model probabilities, conditioning on an estimate of the\nlatent positions, but integrating over the other parameters. We find the integrated likelihood\nof the observations and the estimated latent positions for each number of clusters. This was\nproposed by Oh and Raftery (2001, 2003) and worked well in a setting that was similar to the\npresent one. There are several reasons for taking this approach. When selecting a model, we are\n308 M. S. Handcock, A. E. Raftery and J. M. Tantrum\ntypically selecting an estimated configuration for visualization and interpretation, so it makes\nsense to evaluate the specific configuration of latent positions that will be used, rather than an\naverage over the distribution of latent positions. When comparing different numbers of clusters,\nthe dimension of the latent position parameter set that we condition on is the same regardless\nof the number of clusters. Finally, the dimension of the set of latent positions is high, and this\ncan make it difficult to compute the integrated likelihood in a stable way.\nFor each value of the number of clusters, G, considered, we estimate the integrated likelihood\nof .Y, ^\nZ|G/, with ^\nZ being a posterior estimate of the position of the actors. We choose the\nvalue of G that gives the largest value of P.Y, ^\nZ|G/. Letting  =.g, g, 2\ng\n/G\n, the integrated\nlikelihood is\nP.Y, ^\nZ|G/= P.Y, ^\nZ|X,,/ p./ p./ d d\n= P.Y| ^\nZ,X,/ P. ^\nZ|/ p./ p./ d d\n= P.Y| ^\nZ,X,/ p./ d P. ^\nZ|/ p./ d,\nwhere all terms are conditional on G.\nThe first integral on the right-hand side is the integrated likelihood for logistic regression of\nthe observed ties conditional on the latent positions and the observed attributes, and the second\nintegral is the integrated likelihood for the mixture model describing the latent positions. We\napproximate both of these integrals by using the BIC approximation (Schwarz, 1978). The BIC\napproximation for the integrated likelihood of a model for data D with nparam parameters  and\nnobs observations is\n2 log{P.D/}2 log{P.D| ^\n/}-nparam log.nobs/: .10/\nThe BIC approximation for the logistic regression is\n=2 log[P{Y| ^\nZ, X, ^\n. ^\nZ/}]-dlogit log.nlogit/,\nwhere ^\n. ^\nZ/ is the maximum likelihood estimator of  given that the latent positions are Z = ^\nZ,\ndlogit\n= dim./ is the number of parameters in the logistic regression model and nlogit is the\nnumber of ties in the data. A possible alternative choice for nlogit is the number of possible ties,\nn.n - 1/. We chose nlogit to be the number of actual rather than possible ties, on the basis of\narguments that are analogous to those of Volinsky and Raftery (2000).\nThe BIC approximation for the mixture model is\nBICmbc\n=2 log[P{ ^\nZ| ^\n. ^\nZ/}]-dmbc log.n/,\nwhere dmbc is the number of parameters in the clustering model, and ^\n. ^\nZ/ is the maximum\nlikelihood estimator of  given that the latent positions are Z = ^\nZ. Our final approximation is\n+BICmbc:\nFor both BIClr and BICmbc, we use the minimum Kullback\u00adLeibler estimates of the latent\npositions in the maximization of the likelihoods.\n5. Examples\n5.1. Example 1: liking between monks\nWe consider the social relations between 18 monks in an isolated American monastery (Samp-\nClustering for Social Networks 309\nW\nL\nL\nL\nL\nL\nW\nT\nT\nT\nT\nT\nT\nT\nW\nO\nO\nO\nFig. 1. Relationships between monks within a monastery: groups from two-stage maximum likelihood esti-\nmation of the latent position cluster model with three groups are shown by the colours of the nodes; a\ngrouping given by Sampson (1969) is shown by the letters T (Turks), L (Loyal Opposition), O (Outcasts) and\nW (Waverers) (, ties (i.e. the data))\nson, 1969; White et al., 1976). While resident at the monastery, Sampson collected extensive\nsociometric information by using interviews, experiments and observation. Here we focus on\nthe social relation of `liking'. We say that a monk has the social relation of `like' to another monk\nif he ranked that monk in the top three monks for positive affect in any of three interviews given\nover a 12-month period.\nWe first consider the two-stage maximum likelihood estimation method, and the associated\nmodel selection approach. The maximum likelihood latent space positions from the first stage\nof the method are shown in Fig. 1. The BIC from the model-based clustering of the second stage\nchose only one cluster. If we specify there to be three clusters, we obtain the estimated clusters\nthat are shown in Fig. 1.\nThe data that were collected by Sampson (1969) have received much attention in the social net-\nworks literature (White et al., 1976; Wasserman and Faust, 1994). Sampson provided a descrip-\ntion of the clustering based on information that was collected at the end of the study period.\nHe identified three main groups: the Young Turks (seven members), the Loyal Opposition (five\nmembers) and the Outcasts (three members). The other three monks wavered between the Loyal\n310 M. S. Handcock, A. E. Raftery and J. M. Tantrum\nTable 1. Two-stage maximum likelihood and Bayesian estimates of the parameters of the latent position\ncluster model for the relationship between monks within a monastery\nParameter Two-stage Lower Latent position Upper Posterior Posterior\nlikelihood posterior deviation conditional\nmedian on ^\nZ\nOpposition and the Young Turks, which he described as being in intense conflict (Sampson\nSampson are indicated by letters in Fig. 1. The data that we model here include only one of the\nrelationships that Sampson considered in his analysis.\nIn our two-stage solution, the Young Turks form their own group, and the Loyal Opposition\nand Outcasts are each contained in separate groups. The Waverers are split, with one clustered\nwith the Outcasts and the other two with the Loyal Opposition. White et al. (1976) developed\nblockmodels for social relations within the monastery based on eight positive and negative\nsocial relations. Although their methodology was different, their primary objective was cluster-\ning of the monks. Their model found three groups in the monastery; the groups coincide exactly\nwith those from our two-stage method when the number of groups is constrained to be 3 (White\net al. (1976), page 753). Our model yields the same results as theirs, even though they used much\nmore information.\nWe then fitted our Bayesian model using MCMC sampling with 5000 burn-in iterations that\nwere discarded, and a further 30000 iterations, of which we kept every 30th value. Visual dis-\nplay of trace plots and more formal assessments of convergence (e.g. Raftery and Lewis (1996))\nindicated that this gave results that were sufficiently accurate for our purposes. The parameter\nestimates from the two-stage and Bayesian methods are shown in Table 1.\nThe plot of the BIC values is given in Fig. 2 and indicates a clear choice of three clusters. This\nis in line with the previous research.\nFig. 3 shows the minimum Kullback\u00adLeibler estimates of the social positions of the monks for\nthe three-cluster model. The monks are well separated into the three clusters--even the monk\nfrom the Loyal Opposition who had five ties to the other monks within his group and three ties\nto the Young Turks is now well separated from the Young Turks. The Young Turks are also more\ntightly clustered than the Loyal Opposition. Sampson's analysis indicated larger heterogeneity\nof actors within the Loyal Opposition group. This is reflected in the fissure between two com-\nponents of the Loyal Opposition. The Outcasts are also closely bound, and the Waverer who is\nClustering for Social Networks 311\nNumber of Clusters\nBIC\nFig. 2. BIC plot for the latent position clustering model of the relationship between monks within a monastery\nW\nL\nL\nL\nL\nL\nW\nT\nT\nT\nT\nT\nT\nT\nW\nO\nO\nO\nFig. 3. Estimates of clusters and latent positions for the relationship between monks within a monastery\nfrom the Bayesian estimation of the latent position cluster model: the probability of assignment to each latent\ncluster is shown by a pie chart\nclustered with them is the farthest from the others. Overall the Bayesian estimate of the latent\nposition cluster model produces greater distinctions between the groups than the two-stage\nestimate and firmly identifies the grouping of the Waverers.\nThe uncertainty in the cluster assignments is shown in Fig. 3, where the cluster assignment\nprobabilities for each actor are shown as pie charts. We see that most actors have almost no\nprobability of belonging to any other cluster--except for one of the Young Turks.\n312 M. S. Handcock, A. E. Raftery and J. M. Tantrum\nFig. 4. Two-stage maximum likelihood estimates of the latent positions and clusters for the adolescent\nhealth data, where the number of clusters (2) is chosen by BIC: clusters are shown by colour with actual\ngrades shown as numbers\nThe two-stage method performs well here when the number of clusters is known in advance.\nHowever, the Bayesian method correctly estimates the number of groups and also yields tighter\nestimates of the latent positions. This is because it borrows strength from the clustering infor-\nmation when estimating the latent positions. The Bayesian approach allows the uncertainty in\ncluster assignment to take into account the uncertainty in actor position and vice versa, and\nthis turns out to be important for these data.\n5.2. Example 2: adolescent health\nThe second social network is from the National Longitudinal Study of Adolescent Health. The\nstudy is a school-based longitudinal study of the health-related behaviours of adolescents and\nClustering for Social Networks 313\nFig. 5. Clusters from two-stage maximum likelihood estimates of the latent position cluster model for the\nadolescent health data, where the number of clusters is constrained to be 6: clusters are shown by colour\nwith actual grades shown as numbers; there are six green points, representing students from grade 9, two\nof which are coincident\ntheir outcomes in young adulthood. The study design sampled 80 high schools and 52 middle\nschools from the USA that were representative with respect to region of the country, urbanicity,\nnaire was administered to a nationally representative sample of students in grades 7\u00ad12. In\naddition to demographic and contextual information, each respondent was asked to nominate\nup to five boys and five girls within the school whom they regarded as their best friends. Thus\neach student could nominate up to 10 students within the school (Udry, 2003).\nHere we consider a single school of 71 adolescents from grades 7\u00ad12. We consider the friend-\nship nominations between those who have either nominated at least one other adolescent as\ntheir friend or who have been nominated at least once as the friend of another adolescent. Two\n314 M. S. Handcock, A. E. Raftery and J. M. Tantrum\nTable 2. Adolescent health data: clusters from two-stage\nmaximum likelihood estimation of the latent position cluster\nmodel with six clusters, compared with the student's grades\nGrade Results for the following clusters:\nadolescents who had no ties in the network were excluded. The remaining 69 adolescents form\na connected directed network with nodes the adolescents and nominations the ties.\nWe fitted the latent position cluster model without using the grades of the adolescents. Instead\nwe used the grade information for assessing the clustering. The two-stage maximum likelihood\nestimates of the latent positions are given in Fig. 4. The approximate BIC values based on the\ntwo-stage maximum likelihood estimates chose two clusters, which seems a poor choice given\nthe grade information. When we required six clusters, we obtained the results that are shown\nin Fig. 5. Now the clusters have a loose correspondence to grade and most actors of the same\ngrade are close to each other.\nThe correspondence between clusters and grade is shown in Table 2. The seventh- and eighth-\ngrade adolescents belong to two clusters that are mostly homogeneous with respect to grade.\nThe ninth-grade adolescents fall into two clusters. The 10th-, 11th- and 12th-grade adolescents\nfall into two clusters, one of which includes all four 12th graders.\nWe fitted our Bayesian model using MCMC sampling with 50000 burn-in iterations that were\ndiscarded, and a further 2 million iterations, of which we kept every 1000th value. The result-\nNumber of Clusters\nBIC\nFig. 6. BIC-plot for the latent position cluster model of the adolescent health network\nClustering for Social Networks 315\nTable 3. Two-stage maximum likelihood estimates and Bayesian estimates of the parameters of the latent\nposition cluster model for the adolescent health network\nParameter Latent position Lower Latent position Upper Posterior Posterior\nmixture model 2.5% cluster model 97.5% standard median\nestimate posterior deviation conditional\nmedian on ^\nZ\ning BIC (Fig. 6) chose six clusters. This is the same as the number of grades, and the clusters\ncorrespond roughly to the grades, so the BIC estimate has some face validity.\nThe parameter estimates for both the two-stage and the Bayesian estimates of the latent\nposition cluster model are shown in Table 3. Fig. 7 shows the Bayesian estimates of the chil-\ndren's social positions for the six-cluster model.\nAs we would expect the students to tend to be linked to others in their own grade, we can\ncompare the clusters that are identified by the model with the grades. As the model is unaware\nof the grades of the students, we are asking the model to identify a latent clustering that should\nbe a partial surrogate for grade. The clusters correspond quite well to grades. This comparison\nis summarized in Table 4.\nThe seventh-grade adolescents are in their own well-separated cluster, with the exception of\none seventh grader whose only friends are eighth graders (possibly a student who had been held\nback). The eighth graders are mostly in their own cluster, with two having stronger ties to the\nninth-grade class and so being incorporated in that cluster. The ninth-grade class is split into\ntwo clusters, the social magentas and the cliquey greens. The magenta ninth-grade cluster has\nmany ties to other clusters, whereas the ties from the green ninth-grade cluster to other clusters\nare mostly to the other (magenta) ninth-grade cluster. The 11th grader whose only friend is a\ngreen ninth grader is more likely to belong to the green cluster ninth grade than to any other.\n316 M. S. Handcock, A. E. Raftery and J. M. Tantrum\nFig. 7. Bayesian estimates of posterior clusters and latent positions for the friendship network in the ado-\nlescent health school: latent clusters are shown by colour with actual grades shown as numbers\nThe 10th-, 11th- and 12th-grade classes belong to two clusters which are very close in the\nlatent social space. The 10th-grade class is entirely contained within the blue cluster, and most\nof the 11th graders and all the 12th graders are in the black cluster.\nThus the model has identified the strong tendency of students to form ties with others in their\nown grade, as the clusters line up well but not perfectly with the grades. There is also a more\nsubtle tendency for the within-grade cohesion to weaken as students move up in the school, from\nthe tightly linked seventh graders to the more loosely tied students in the top three grades, who\nassociate more easily with students in grades other than their own. This may reflect a tendency\nof students to form links increasingly based on common interests and personal affinity and less\non the grade that they happen to be in, as they gain seniority.\nFig. 8 shows the cluster assignment probabilities for each student. Students in the magenta\ncluster also have a significant probability of belonging to the cyan eighth grade cluster, whereas\nClustering for Social Networks 317\nTable 4. Clusters from the latent position cluster model\ncompared with the student's grades for the adolescent\nhealth network\nGrade Results for the following clusters:\nNote the concordance between the clusters and the actual\ngrades.\nthe magenta ninth graders have significant probability of belonging only to the magenta and\ngreen clusters. The uncertainty in cluster assignment between the blue and black clusters is\nclearly visible.\nThe Bayesian method provides a much better estimate of the number of groups than the two-\nstage maximum likelihood estimation approach. The clusters are well defined in terms of both\ntheir positions in space and their correspondence to the grades. This is reflected in the estimates\nof the positions and the uncertainty in cluster membership (Fig. 8).\n6. Discussion\nWe have proposed a new model for social networks: the latent position cluster model. This\ncaptures three important commonly observed features of networks, namely transitivity, hom-\nophily on attributes and clustering. We have developed two methods for estimating the latent\npositions and the model parameters: a simple two-stage maximum likelihood procedure and a\nfully Bayesian approach using MCMC sampling. We have also developed a Bayesian approach\nto finding the number of clusters in the data. The methods work well for two data sets. The two-\nstage maximum likelihood estimation approach works fairly well and is simple to implement,\nwhereas the fully Bayesian approach performs better but is more complex.\nThe model can be thought of as a restriction of the latent position model to represent coher-\nent groups of actors within the network better. It links the observed patterns of ties to latent\npositions where the latter may be partially determined by unobserved attributes of the actors in\naddition to social forces.\nOur approach could be extended in several ways. We have developed it as a model for directed\nties, but it could easily be adapted to data involving undirected ties: instead of a likelihood\ncomponent for each ordered pair of actors .i,j/ and .j, i/, there would then be only one, for\nthe unordered pair .i,j/. We have specified our model as a model for binary ties: present or\nabsent. However, network ties often have non-binary values, such as counts (e.g. the number of\nphone calls between two people), or continuous values (e.g. the volume of trade between two\ncountries). Our model can be easily extended to these situations by replacing the binary logistic\nregression of equation (2) by a generalized linear model or another specification of dependence.\nWe have required the dimension of the latent social space to be specified by the user. It could\nbe desirable to estimate this from the data, and this is possible by using methods that are similar\n318 M. S. Handcock, A. E. Raftery and J. M. Tantrum\nFig. 8. Pie charts for posterior probabilities of cluster assignment for each actor, at the Bayesian estimates\nof posterior latent positions for the friendship network in the adolescent health school: the students' grades\nare shown as numbers\nto those in Section 4, as developed in a slightly different context by Oh and Raftery (2001).\nThe use of two dimensions leads to easy visualization, but higher dimensions may be needed to\nrepresent the network adequately, especially for larger networks.\nTwo important local characteristics of networks are the tendency for a tie within a dyad to\nbe reciprocated, and for triads to be transitive. The latent position cluster model determines\nthese characteristics on the basis of the distances between the actors and their covariate values.\nThe propensity for reciprocity and transitivity in a data set may be higher or lower than that\nprescribed by the model. For the applications that were considered in this paper the posterior\nmean reciprocity and transitivity are consistent with the levels in the data. However, the model\nmay need to be extended to model reciprocity and transitivity in other networks explicitly.\nClustering for Social Networks 319\nOne important aspect of social networks that our model does not explicitly incorporate is\nthe differing tendency of actors to send and receive ties. The model could be extended to this\nsituation by including random effects for the propensity of actors to send and receive ties in\nequation (2), similarly to van Duijn et al. (2004) and Hoff (2005). In our examples, the propen-\nsities of the actors to receive ties (although not to send them) differed considerably, and our\nmodel reflects this sufficiently well, but if the differences were much more extreme the model as\ncurrently specified might have difficulties.\nOne use of social network models is to provide inputs to models of larger systems of which\nthe networks are part. An important example of this is epidemiological modelling of the spread\nof contagious diseases (Kretzschmar and Morris, 1996; Bearman et al., 2004; Eames and Keel-\ning, 2004; Eubank et al., 2004). It is easy to simulate realizations from our model conditional\non estimated or specified parameters and, by using draws from the posterior distribution, one\ncan simulate a realistic range of scenarios. Often there is interest in simulating an entire pop-\nulation for which network data are available for only a small part. This could be done using\nour model, if necessary by combining it with a simple model such as a Poisson process for the\nmeans of clusters that were not represented in the data that were analysed. Although feasible,\nour method is computationally demanding, and so for larger networks more computationally\nefficient versions of our estimation methods should be sought.\nThe model has many potential application areas. The applications in this paper focus on\nsocial relations where the ties represents positive affect. Network phenomena are ubiquitous in\nthe sciences (e.g. biology, information sciences and epidemiology). The model applies to diverse\ntypes of relationships (e.g. biological interaction, exchange, co-citation, common affiliations or\nfood source) and nodes (e.g. proteins, villages, authors and organizations, or animals).\nAn R package called latentnet has been written to implement the procedures in this paper\n(Handcock et al., 2004). The package is publicly available on the Comprehensive R Archive Net-\nwork, at http://cran.r-project.org.\n"
}