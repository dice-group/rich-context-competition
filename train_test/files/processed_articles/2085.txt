{
    "abstract": "Participants in longitudinal studies on the effects of drug treatment and criminal justice system interventions are at high risk for institutionalization (e.g., spending time in an environment where their freedom to use drugs, commit crimes, or engage in risky behavior may be circumscribed). Methods used for estimating treatment effects in the presence of institutionalization during follow-up can be highly sensitive to assumptions that are unlikely to be met in applications and thus likely to yield misleading inferences. In this paper we consider the use of principal stratification to control for institution- alization at follow-up. Principal stratification has been suggested for similar problems where outcomes are unobservable for samples of study participants because of dropout, death or other forms of censoring. The method identifies principal strata within which causal effects are well defined and potentially estimable. We extend the method of principal stratification to model insti- tutionalization at follow-up and estimate the effect of residential substance abuse treatment versus outpatient services in a large scale study of adoles- cent substance abuse treatment programs. Additionally, we discuss practical issues in applying the principal stratification model to data. We show via sim- ulation studies that the model can only recover true effects provided the data meet strenuous demands and that there must be caution taken when imple- menting principal stratification as a technique to control for post-treatment confounders such as institutionalization. 1. Introduction. Each year almost 1.8 million Americans receive alcohol and other drug treatment services. Efforts to improve these services through research or provider profiling are hindered by drug treatment clients' high rates of post- treatment institutionalization, defined here as spending a day or more in a con- trolled environment (e.g., a jail, prison, hospital, residential treatment or group home setting) where the possibility of drug use and criminal activity is substan- tially diminished. By reducing the potential for substance use, institutionalization masks the potential effects of substance use treatment programs. For example, out-",
    "reduced_content": "The Annals of Applied Statistics\n\u00a9 Institute of Mathematical Statistics, 2008\n \nParticipants in longitudinal studies on the effects of drug treatment and\ncriminal justice system interventions are at high risk for institutionalization\n(e.g., spending time in an environment where their freedom to use drugs,\ncommit crimes, or engage in risky behavior may be circumscribed). Methods\nused for estimating treatment effects in the presence of institutionalization\nduring follow-up can be highly sensitive to assumptions that are unlikely to\nbe met in applications and thus likely to yield misleading inferences. In this\npaper we consider the use of principal stratification to control for institution-\nalization at follow-up. Principal stratification has been suggested for similar\nproblems where outcomes are unobservable for samples of study participants\nbecause of dropout, death or other forms of censoring. The method identifies\nprincipal strata within which causal effects are well defined and potentially\nestimable. We extend the method of principal stratification to model insti-\ntutionalization at follow-up and estimate the effect of residential substance\nabuse treatment versus outpatient services in a large scale study of adoles-\ncent substance abuse treatment programs. Additionally, we discuss practical\nissues in applying the principal stratification model to data. We show via sim-\nulation studies that the model can only recover true effects provided the data\nmeet strenuous demands and that there must be caution taken when imple-\nmenting principal stratification as a technique to control for post-treatment\nconfounders such as institutionalization.\n1. Introduction. Each year almost 1.8 million Americans receive alcohol and\nother drug treatment services. Efforts to improve these services through research\nor provider profiling are hindered by drug treatment clients' high rates of post-\ntreatment institutionalization, defined here as spending a day or more in a con-\ntrolled environment (e.g., a jail, prison, hospital, residential treatment or group\nhome setting) where the possibility of drug use and criminal activity is substan-\ntially diminished. By reducing the potential for substance use, institutionalization\nmasks the potential effects of substance use treatment programs. For example, out-\nKey words and phrases. Principal stratification, post-treatment confounder, institutionalization,\ncausal inference.\ncomes of clients from both effective and ineffective treatment programs will look\nthe same when they have no access to drugs or alcohol.\nThe confounding of treatment effects due to institutionalization cannot be\nignored when evaluating substance abuse treatment programs, because institu-\ntionalization is so pervasive among drug treatment clients. For instance, in the\nDrug Abuse Treatment Outcomes Study [Hubbard et al. (1997)], 40% of the\n2,966 clients in substance abuse treatment programs interviewed 12-months af-\nter discharge reported being institutionalized for some part of the preceding year\n[U.S. Dept. of Health and Human Services, National Institute on Drug Abuse\n(2004)]. Among those with any institutionalization, the average number of days\ninstitutionalized out of the past 365 was 115 [U.S. Dept. of Health and Human\nServices, National Institute on Drug Abuse (2004)]. Similarly, about 52% of the\nsample from the National Treatment Improvement Evaluation (NTIES) [U.S. Dept.\nof Health and Human Services, Substance Abuse and Mental Health Services\nAdministration, Center for Substance Abuse Treatment (2004), NORC and RTI\n(1997)] were institutionalized during the study's 12-month post-treatment evalua-\ntion, many for the entire length of the evaluation period.\nThe confounding effects of institutionalization are not, however, limited to sub-\nstance abuse treatment programs. Criminal justice system clients are also at great\nrisk for being institutionalized following an intervention. Moreover, patients in-\nvolved in many health studies are at risk for hospitalizations which can limit or sup-\npress the measurement of primary outcomes of interest in those studies (e.g., daily\nphysical activities for a general population or falls for geriatric patients). In all\nof these cases, a post-treatment factor (e.g., institutionalization or hospitalization)\nwhose value is determined after the start of treatment consequently determines the\npotential range of the outcome that can be observed, thereby suppressing or cen-\nsoring the outcome of primary interest. In many situations, inferences are further\ncomplicated by the fact that the confounding factor can take on many levels giving\nrise to outcomes which are observed at different values of the confounding vari-\nable and invalidating the comparability of outcomes in the treatment and control\ngroups.\nIn a recent paper McCaffrey et al. (2007) developed a statistical model to de-\nscribe the different possible estimates of the causal effect of treatment in the pres-\nence of institutionalization and the potential confounding effects of institutional-\nization on these estimates. The paper identifies commonly used analytic methods\nfor estimating treatment effects in the presence of institutionalization and demon-\nstrates that the estimated treatment effects can vary greatly depending on which\nmethod is employed. The paper also identifies assumptions under which the var-\nious approaches yield unbiased estimates of the treatment effects of interest. Un-\nfortunately many of the assumptions required appear unlikely to hold in most real\nworld applications.\nInstitutionalization is similar to the problem of incomplete compliance in drug\ntrials. In both problems, cases assigned to treatment have multiple potential out-\ncomes that can vary depending on a variable not controlled by the experimenter:\ndose of the drug (i.e., level of compliance) in drug trials or days institutionalized in\nour example. Hence, methods for estimating the dose-response curve from partial\ncompliance data [Efron and Feldman (1991)] might apply to the institutionaliza-\ntion problem. However, these methods make substantial use of the fact that treat-\nment is a complete dose of the drug, whereas, in our example institutionalization\nis not related to the amount or type of treatment received but is an external event\nthat curtails use censoring the outcomes of interest.\nThe problem of institutionalization is more similar to the problems addressed by\nthe methods of principal stratification. Developed by Frangakis and Rubin (2002)\nfor problems where outcomes are unobservable for samples of study participants\nbecause of dropout, death or other forms of censoring (e.g., failure to find employ-\nment in a jobs program), the method identifies principal strata within which causal\neffects are well defined and potentially estimable. Roughly speaking, Frangakis\nand Rubin (2002) noted that in data with censoring, cases that receive treatment\nand have observed outcomes are a mix of cases that would have observed outcomes\nunder control and those that would not. Similarly, cases that receive the control\ncondition and have observed outcomes are a mix of cases that would have observed\noutcomes under treatment and those that would not. A study participant's censor-\ning statuses under the treatment and control conditions define the strata within the\npopulation, called principal strata. Analyses that condition on cases in the stratum\nwhere participants would be observed under both treatment and control can pro-\nvide unbiased treatment effect estimates for that stratum assuming no other biasing\nfactors. The key innovation to the work of principal stratification is the recognition\nthat conditioning on censoring statuses under treatment and control is sufficient to\nallow for unbiased estimation of treatment effects.\nPrincipal strata notions extend to the problem of institutionalization at follow-\nup with only slight modifications to the methods for censored data. In particular,\nmodifications are necessary because institutionalization can take on more than the\ntwo levels of censored and uncensored. Also, outcomes are observed at all levels\nof institutionalization and treatment effects at various levels may be of interest.\nUsing data from the Adolescent Treatment Models (ATM) study, fielded be-\nistration, Center for Substance Abuse Treatment, we aim to examine the effects of\ntreatment modality (residential versus outpatient) on the 12-month substance use\noutcomes for adolescents who participated in the ATM using principal stratifica-\ntion. In the ATM, high rates of institutionalization clearly confound the effects of\ntreatment modality. Adolescents in residential treatment have significantly higher\nrates of institutionalization and lower mean drug use frequency outcomes at the\n12-month follow-up. Given that institutionalization in the sample can be shown\nto yield lower drug use outcomes [McCaffrey et al. (2007)], it is unclear whether\nadolescents in residential treatment truly have lower mean values of the outcome\nbecause the treatment is more effective than outpatient treatment or because they\ntend to be institutionalized more often.\nThe goal of this paper is to extend principal stratification to control for the con-\nfounding effects of institutionalization and to evaluate the sensitivity of the ex-\ntended model to various assumptions about the data. Section 2 describes the data\nfrom the ATM study and illustrates the confounding effects institutionalization is\nlikely to have when examining treatment effects in this study. Section 3 describes\nthe method of principal stratification and its extension in more detail and applies\nthe method to the ATM data to examine the effects of substance use treatment\nmodality (residential versus outpatient) on drug use outcomes for adolescents in\nthe study. Section 4 evaluates the principal stratification method presented using\na series of simulation studies and Section 5 provides a discussion of our findings\nand recommendations for practice and future research.\n2. Adolescent treatment models study and the institutionalization con-\nfound. The number of adolescents receiving substance abuse treatment has in-\ncreased by over 65% in the last 10 or so years and policy makers, clinicians and\nparents want to know if treatment is effective and for whom it is effective, as\nwell as what treatment modalities are best. We address these questions through\na study of the effects of treatment modality (residential versus outpatient) on the\n12-month substance use outcomes for adolescents who participated in the ATM\nstudy. The ATM study collected treatment admission and 12-month outcomes data\nfor new admissions to 10 community-based treatment programs in the United\nStates, including six residential programs and four outpatient programs [Stevens\nThe sample used in the present analysis includes all new admissions to the 10\nprograms in the main ATM analytic dataset, which was produced in March of\nand provided data on the outcomes of interest. Only cases with follow-up data are\nincluded in the analysis presented below.\nFor purposes of the illustrations presented in this report, we examine the effects\nof treatment modality on the Substance Frequency Scale (SFS), a widely used scale\nfrom the Global Appraisal of Individual Needs (GAIN) [Dennis (1999)], the survey\ninstrument used at every site for baseline and 12-month outcome assessments. The\nSFS averages responses to a series of questions on the frequency of recent drug\nuse, intoxication and drug problems in the 90 days prior to the 12 month follow-\nup.1 It is scaled so that higher values indicate greater substance use and more drug\nproblems. Days of institutionalization at follow-up is assessed with the maximum\nnumber of days--in the past 90--which the respondent reports being in any of\nseveral different types of controlled environments (e.g., inpatient psychiatric or\nmedical hospitals, residential treatment facilities, juvenile halls or other criminal\njustice detention facilities, etc.).\n1In this illustration we multiplied SFS by 90 to make it scale with use in the past 90 days rather\nthan use per day.\nFigure 1 shows a scatter plot and smooth of mean SFS versus the number of\nmonths institutionalized for adolescents enrolled in residential and outpatient care\ntreatment modalities in the ATM. As shown, more adolescents in residential treat-\nment have months of institutionalization greater than 0. In fact, 52% of adolescents\nin residential care were institutionalized for at least one day in the past 90 at the\n12-month follow-up, while only 38% of adolescents in outpatient care were insti-\ntutionalized at follow-up (see Table 1). Figure 1 also reveals the suppression effect\nthat institutionalization can have on SFS. As the number of months institutional-\nized increases, the observed values of SFS in the ATM data appear to decrease.\nThis relationship can be seen more clearly in the smooth of SFS versus days insti-\ntutionalized also shown in the figure.\nIn addition to the suppression effect of institutionalization, Figure 1 also clearly\nreveals the potential selection effects that exists in this data between adolescents\nwith and without any days of institutionalization. The mean value of SFS for ado-\nlescents who are not institutionalized at follow-up (represented by the black X\nabove 0 days institutionalized in Figure 1) is markedly lower than the mean val-\nues for adolescents with only a few days of institutionalization (shown along the\nsmoothed line in Figure 1). The difference in mean SFS between these adolescents\nsuggests that adolescents who were institutionalized in the 90 days prior to the\n12 month follow-up tended to be more difficult cases with higher levels of drug\nuse than those adolescents not entering institutional settings.\nFIG. 1. Scatter plot of SFS values by number of months institutionalized for adolescents in both\nresidential and outpatient treatment modalities with smooth of mean SFS by months institutionalized\noverlayed. The black X denotes the mean SFS value among adolescents with 0 days of institutional-\nization.\nWeighted mean rate of institutionalization and SFS at 12-month follow-up\nby treatment modality\nPercent institutionalized at follow-up Mean SFS\nBoth the suppression and selection effects of institutionalization in the ATM\ndata could distort inferences about the effects of treatment on SFS. Table 1 on\npage 1039 provides weighted descriptive statistics (see below for more details on\nweighting) for SFS and institutionalization at follow-up by treatment modality. As\nshown, adolescents in residential treatment have higher rates of institutionalization\nand lower mean SFS. Given that institutionalization appears to suppress substance\nuse in this sample, it is unclear whether adolescents in residential treatment have\nlower mean values of SFS because they have decreased their substance use in\nresponse to residential treatment or because they tend to be institutionalized more\noften.\nUnfortunately, as described in McCaffrey et al. (2007), current methods for han-\ndling institutionalization are not adequate and require strong assumptions which\nare unlikely to hold in practice. In light of these findings, we propose the use of\nprincipal stratification to obtain policy-relevant treatment effects on this data which\nappropriately control for the suppression and selection effects institutionalization\ncan have on SFS.\n3. Principal stratification. Principal stratification was developed by Fran-\ngakis and Rubin (2002) as a method for accounting for post-treatment confounds\nwithin the context of the Neyman\u00adRubin causal model. Hence, we begin by ex-\ntending the Neyman\u00adRubin causal model to account for institutionalization and\nthen turn to describe the specific innovations of the principal stratification ap-\nproach.\n3.1. A causal model for treatment effects in the presence of institutionalization.\nWe start by considering the treatment effect of a single intervention versus a control\nin the simple case without any institutionalization. In this case, the Neyman\u00adRubin\ncausal model [Holland (1986), Pearl (1996)] considers two potential outcomes and\none random variable for each case in the study. The potential outcomes are Y0, the\noutcome after receiving the control condition, and Y1, the outcome after receiv-\ning the treatment condition. Throughout we assume that the Stable Unit Treatment\nValue Assumption (SUTVA) [Rubin (1990)] holds so that for each case the poten-\ntial outcomes are unique and well defined.\nThe treatment effect for each individual is Y1\n-Y0. Typically this is summarized\nby its mean across study participants. However, we cannot directly estimate the\ntreatment effect for individual cases or the mean across cases because cases cannot\nbe observed under both the treatment and the control conditions. The condition un-\nder which each case is observed is determined by the random treatment assignment\nvariable T , which equals 1 for treatment and 0 for control. When T = 1, we ob-\nserve Y1, otherwise Y0 is observed. This results in the random variable Yobs\n= YT .\nUnbiased estimation of the average treatment effect is possible if cases with\nT = 1 have the same expected values of their potential outcomes as cases with\nT = 0. Under this assumption, E(Yobs\n|T = 1) = E(Y1) and E(Yobs\nE(Y0), where expectation is over the participating cases. Hence, the difference\nin the observed treatment and control means yields an unbiased estimate of the\naverage causal effect of treatment.\nConsistent estimation is also possible in situations where treatment assignment\nmight depend on observable characteristics, such as observational studies where\nstudy participants self-select into the treatment programs being studied. In such\ncircumstances, consistent estimates can be obtained by comparing the means for\ncases with the same probability of treatment and using propensity score weights\nto adjust for selection effects into a particular treatment [Rosenbaum and Rubin\nIn the presence of institutionalization, the Neyman\u00adRubin causal model de-\nscribed above must be expanded to allow for cases to have potential levels of insti-\ntutionalization, which we denote by Z0 and Z1 for the control and treatment con-\nditions, respectively. The model must also allow for different potential outcomes at\neach level of institutionalization. For example, a case might have a different poten-\ntial outcome when institutionalized 0 days, compared to 1, 2 or 3 or more days. We\nlet Zmax equal the maximum possible value for institutionalization. Then, for treat-\nment, T = 1, we label the potential outcomes for a case as Y1\n[z], z = 0,...,Zmax\nso that Y1\n[0] is the potential outcome if assigned to treatment and not institution-\nalized during the follow-up period and Y1\n[1] is the potential outcome if assigned\nto treatment and had 1 day of institutionalization, and so on to Zmax. The potential\noutcomes for control are Y0\n[z], z = 0,...,Zmax.\nNow, for each case, we can define different treatment effects for each of the\ndifferent levels of institutionalization, for example, D[z] = Y1\n[z] such that\nD[z] might change with z. While there are multiple causal effects that might be\nof interest, not all may be estimable from the data without strong assumptions. We\nmight, for example, be interested in the average causal effect of D[0], the average\ncausal effect had no one been institutionalized, which McCaffrey et al. (2007)\nrefer to as the \"unsuppressed treatment effect.\" Additionally, we might also want\nto estimate the average causal effect for cases at each of the observed values of\ninstitutionalization as was considered when the notion of principal stratification\nwas derived [Frangakis and Rubin (2002)]. We now turn to that concept.\nPrincipal stratification model for institutionalization under treatment t = 0,1\nf (y;Zmax,0,t ))\nf (y;Zmax,1,t ))\nf (y;Zmax,2,t ))\n\u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7\n\u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7\n\u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7 \u00b7\nZmax (p0,Zmax\n,\nf (y;0,Zmax,t ))\n,\nf (y;1,Zmax,t ))\n\u00b7 \u00b7 \u00b7 (pZmax,Zmax\n,\nf (y;Zmax,Zmax,t ))\n3.2. Principal stratification. To estimate the causal effects of treatment using\nthe notions of principal stratification, we need a model for both the outcomes and\ninstitutionalization. Specifically, we assume that institutionalization can take on\nonly a discrete set of values 0,1,...,Zmax for both treatment and control. For\nexample, if the follow-up interval for observing outcomes is 90 days, then Z1\nand Z0 can only take on a value from 0 to 90.\nUnder this assumption, we can in turn define Zmax\n Zmax principal strata as\nshown in Table 2. We define the probability that an individual falls into stratum\n} and define a density function for the\npotential outcome Yt\n[zt\n= z1 if a person falls into this stratum by\n= 1,...,Zmax, where z0,z1,t denotes the parameter vector\nfor the assumed underlying density function f and t denotes whether or not an\nindividual received treatment (t = 1) or control (t = 0). We note that the proba-\n, do not depend on treatment status because Z0 and Z1 are potential\noutcomes and a case's principal stratum remains the same regardless of which\ntreatment he/she receives. Conversely, the distribution of the potential outcomes,\nf , is determined by the principal strata and treatment status of an individual. For\nexample, if we can assume the potential outcomes are normally distributed, then\nwe might have separate means and variances in z0,z1,t for each possible pair of\nvalues of (z0,z1) for both treatment and control.\nThe primary treatment effects of interest in this model are E[D[z]|Z0\n= z,\n= z], that is, the treatment effects for individuals with the same level of in-\nstitutionalization under both treatment and control. These treatment effects do not\nconfound changes in institutionalization with other effects of treatment and allow\npolicy-makers, stake holders and caregivers to evaluate treatment independent of\nthe potentially costly and undesirable effects on institutionalization. Each average\neffect is restricted to cases from a principal stratum. Generalizations to other strata\nrequire additional assumptions.\nWe let Szt ,t denote the set of all cases in condition t whose observed value of\ninstitutionalization equals zt . Then if yi denotes the observed outcome for the ith\ncase, the likelihood for the observed data is given by\nL(Y,Z,T,) =\nf (yi\n\u00d7\nf (yi\n.\nThis mixture distribution results from the fact that only Z1 or Z0 is observed for\neach case. A similar likelihood was presented for an application of principal strat-\nification methods for estimating the causal effect of a jobs program [Zhang, Rubin\nand Mealli (2005)]. In their model, Zmax was 1 and the potential outcomes Yt did\nnot exist when Zt\n= 1. In our case, outcomes can exist at every level of institution-\nalization.\nWeights can be easily incorporated into the likelihood function in equation (3.1),\nallowing for maximization of a weighted likelihood function. A natural applica-\ntion of such a weighted likelihood includes the maximization of the likelihood\nwhen comparing propensity score weighted clients in one treatment program to\nunweighted clients in another, as will be illustrated in Section 3.3 below.\nFor many common distributions, mixture likelihoods like (3.1) can be opti-\nmized using the EM algorithm. Theoretically, we can use the EM algorithm to\nestimate causal effects with any set of data. However, in practice, the solution is\nunlikely to be so simple. First, if there are many levels of Z to model, there will\nbe many possible levels of institutionalization; then, without any additional struc-\nture, there will be a very large number of parameters to estimate. To diminish the\ndimensionality of the problem, one can consider modeling z0,z1,t as low order\npolynomials in z0 and z1. For example, we might assume E(Y1\n=\n+  z1z0. Second, it is well known that the convergence\nof likelihood optimizers for mixture models can be sensitive to the starting values\nvolved in this likelihood and the fact that identification of the parameters will de-\npend on matching the mixing proportions/probabilities across groups, sensitivity to\nstarting values is likely and careful consideration of these values will be required.\nWe examine these issues more carefully in Section 4.\n3.3. Application of principal stratification to estimating modality effects on SFS\nin the ATM. To tease out the effect of treatment modality on SFS in the presence\nof institutionalization, we fit a four strata principal stratification model to our data\nfrom the ATM study, where Z0 and Z1 can only take on two values, namely, 0\nand 1. Thus, we dichotomized days institutionalized such that Zt\n= 0 if an indi-\nvidual had 0 days of institutionalization and Zt\nlet t = 1 and = 0 denote residential and outpatient care treatment modalities, re-\nspectively. This model allows us to compute treatment effects among adolescents\nwho would not be institutionalized under both treatment and control and among\nadolescents who would be institutionalized under both treatment and control.\nBecause SFS has a very skewed distribution with many observed zeros (see\nFigure 1), we assumed the underlying distribution for Y within each stra-\nt\ng(y;t\nt\n)1(y>0), where G(y;,2) and g(y;,2) denote the distribution\nand density functions, resp., for a normal random variable with mean  and vari-\nance 2]. The parameters t\nt\ndepend on treatment to allow for treatment\neffects. As parameterized, t\nt\nare not the mean and variance of the tobit\ndistribution but of the truncated normal which defines the tobit.\nBecause the ATM is an observational study, there were observable differences\nin the pretreatment characteristics of youths entering residential and outpatient\ncare. Given these pretreatment differences, any observed differences in treatment\ngroup outcomes could result either from differential effectiveness of the treatment\nmodalities, or because of differences in how hard their respective populations are\nto treat. In order to isolate just the treatment effects of interest, we must compare\ntreatments on equivalent cases. Thus, for the case study, we compare the effec-\ntiveness of the two modalities on cases like those in the ATM sample who entered\nthe residential modality. We achieve this comparison by weighting the outpatient\nsample so that it closely matches the residential sample in terms of the distribution\nof 86 pretreatment variables expected to be related to substance use and treatment\nassignment [Morral, McCaffrey and Ridgeway (2004)]. Details on the weighting\nand comparison of the weighted groups can be found in McCaffrey et al. (2007).\nIn the remainder of the analysis reported in this example, we compare the un-\nweighted residential sample (n = 770) to the weighted outpatient sample (n = 486,\neffective sample size = 125), a comparison designed to examine whether the resi-\ndential modality produces better 12-month outcomes than outpatient care for cases\nwith pretreatment characteristics like those of clients who usually enter residential\ncare. We maximize the weighted likelihood in (3.1) using the EM algorithm. Pre-\nliminary results suggested that estimates could be very sensitive to starting values\nused with the EM algorithm. Consequently, we developed the following approach\nfor selecting starting values.\nFirst, among the residential cases observed to have Z1\n= 0, we fit a mixture\nmodel of two normal distributions using a simple EM algorithm [Dempster, Laird\nand Rubin (1977)] to obtain initial estimates of the two means and their corre-\nsponding mixing proportions for this group. We labeled the two means 1\nand\n. Under our model, we know that the observed means for residential cases\n= 0 is a mixture of 1\nis an estimate of one of these\nmeans and 1\nis an estimate of the other; however, we do not know which is\nwhich. We thus used starting values which allow for both possible mappings in\nthis group.\nWe repeated this procedure for residential cases with Z1\n= 1 and outpatient\ncases for both Z0 equal to 0 and 1. These steps, in turn, yielded preliminary es-\ntimates of the eight mean parameters of the model and their associated mixing\nproportions. All that remained was to determine how the eight means mapped to\nthe model parameters. There are 16 possible mappings from the preliminary esti-\nmates of the simple mixture models to the parameters of the model. For example,\none mapping assumes that (1\n) esti-\n). The remaining 15 mappings\nare obtained by switching the mapping of A and B for each observed value of\nTo obtain the final parameter estimates of the model, we ran the EM algorithm\nto maximize (3.1) separately for each of the 16 possible mappings of the esti-\nmates from the simple mixture models and used as final estimates the solution that\nmaximized the log likelihood among all 16 runs. Simulations described below sug-\ngested that this procedure can successfully recover the global maximum from the\nmany local maxima.\nIt is critical that multiple starting values are utilized when applying principal\nstratification to data. Figure 2 shows the sensitivity of resulting parameter esti-\nmates from the 16 different starting values used in our analysis. The results from\neach set of starting values are plotted as vertical bands and denoted by a number\nfrom 1 to 16. Each of the 8 estimated model means is denoted by a row and the\nresulting estimated values for each mean are plotted for each set of starting values\nusing vertical bars. The first row plots the percentage increase in the negative log-\nlikelihood for each solution compared to the value that minimized it across all sets\nof starting values (estimate 11 in Figure 2). Each set of starting values leads to a\ndifferent possible solution, all of which represent a local minimum of the negative\nlog-likelihood in the data. Although the resulting log-likelihood values are very\nsimilar (differing by no more than 2 percent), each solution gives very different\ninferences about the estimated strata means and treatment effects that exist within\neach stratum. As shown, the solution which gives the minimum negative log like-\nlihood value (denoted by estimate 11 in Figure 2) is distinctly different even from\nthe next best estimate of the model parameters (estimate 6 in Figure 2) which as-\nsigns the estimated values of the means for 1\nand\nin reverse of how they are assigned in the solution. More\ngenerally, it is clear that the alternative solutions tend to find similar values for the\nvarious mean values but \"flip\" the strata labels associated with those labels.\nThe mixture of tobit models appears to fit the data well, as shown in Figure 3\nwhich plots the histogram of fitted probabilities for each observed condition in our\ndata. Goodness of fit can be noted by the grouping of fitted probabilities at 0 and 1\nFIG. 2. The values of the negative log-likelihood and the estimated means for each of the 16 starting\nvalues used in the ATM analysis. Each quantity has a separate y-axis and the estimated value of that\nquantity for each set of starting values is denoted by the heights of the vertical bars.\nfor the cases of each observed condition. These groupings imply that the majority\nof our cases have a high probability of falling into one of the two strata of which\ntheir observed condition is a mixture. If there had been a more even spread of\nthese values, we would worry about the goodness of fit of the model. Moreover,\nTable 3 shows that the principal stratification model maintains the marginal means\nand probabilities of this model.\nThe estimated treatment effects from the mixture model are shown in Table 4.\nIn contrast to the patterns shown in Table 1, when we control for the confound-\ning effects of institutionalization using principal stratification, residential treatment\nleads to significantly worse outcomes among adolescents who would experience\nthe same level of institutionalization under both treatment modalities. The effect\nObserved versus predicted marginal means for residential and outpatient care cases\nResidential care Outpatient care\nPredicted Observed Predicted Observed\nFIG. 3. Histogram of fitted probabilities for each observed condition.\nof residential treatment is larger among adolescents who are not institutionalized\nunder both treatment modalities.\nThe standard errors for treatment effects within each stratum can be adjusted for\nthe effects of clustering (e.g., here adolescents are clustered within treatment sites)\nby using a Huber\u00adWhite sandwich estimate of the variance\u00adcovariance matrix for\nthe parameters in the likelihood function [Skinner, Holt and Smith (1989)]. When\nwe control for clustering within the ATM data, the treatment effects are no longer\nsignificant within the two strata with the same levels of institutionalization under\nboth treatment modalities.\n4. Evaluation of principal stratification. Estimating the treatment effects of\ntreatment modality via principal stratification requires identification of latent vari-\nables from complex mixture data using mixture proportions. In particular, means\nfor cases from different principal strata are identified from the mixing proportions\nTreatment effect estimates and standard errors comparing residential to outpatient treatment using\nthe four-strata principal stratification model. Significant treatment effects are denoted by  and\nstandard errors are unadjusted for clustering\nwithin observed groups. Given that our exploration of starting values suggested\nthat the identification of strata is potentially weak and that label swapping might\nbe possible, we felt it important to explore the properties of the principal stratifica-\ntion method before interpreting our findings on substance abuse treatment. To our\nknowledge, there have been very few studies using either real or simulated data\nsets to explore the convergence of the estimation algorithms, the identification of\ndesired parameters, and the precision of the estimates with varying sample sizes\nfor treatment effects from mixture models like model (3.1).\n4.1. Methods. To evaluate the method of principal stratification, we began by\nexamining the performance of the four strata model where Z0 and Z1 can only\ntake on two values, namely, 0 and 1. Additionally, we assumed that the underly-\ning distribution of the outcome, f (y;z0,z1,t), within each strata is normal with\nmean t\nand variance 2\nt\n, where the means and variances can depend on treat-\nment so that treatment effects can exist. We conducted a simulation study of the\nproperties of parameters estimated by maximizing (3.1) under this assumed para-\nmetric model.\nFirst, data was simulated under this model and the impact of sample size, the\nvalue of the principal strata probabilities, and the dispersion of the means within\neach level of t and Zt on model performance was examined. Second, data was sim-\nulated under heavy tailed and skewed distributions and analyzed using the normal\nmodel to examine the sensitivity of the normal model to model misspecification.\nIn each case, we maximized the likelihood using the methods described above and\ncompared the resulting estimates to the values used in generating the data.\n4.2. Results. First, we examined the performance of the estimators for the\nfour strata model under various assumptions about the sample size per treatment\narm (N), the strata probabilities and the dispersion of the means between strata\nwithin the same level of t and Zt . Figures 4, 5 and 6, respectively, plot the esti-\nmated means for the control group, the estimated means for the treatment group\nand the estimated probabilities for each strata versus their true values under the\nvarious cases considered. As shown, the method did not begin to perform well un-\ntil the means within a given level of t and Zt were at least 1.6 standard deviations\naway from each other and the sample size within each treatment arm was at least\nN = 1000. See supplementary material for tabulated results [Griffin, McCaffrey\nThe performance of the estimators was relatively invariant to the true strata\nprobabilities unless the probabilities were uniform, as shown in the third column\nof Figures 4 and 5. Specifically, we examined three cases for strata probabilities,\none in which all four strata had reasonably large probabilities, another in which one\nstrata had a particularly small probability of 0.05, and a third in which the proba-\nbilities were equal. Performance was similar in the two cases where the probabili-\nties were not all equal, as shown in the first and second columns of Figures 4 and 5.\nFIG. 4. Simulation results. Plot of fitted means (black dots) versus true values (indicated by dashed\nlines) for the four strata in the control group with means for other strata (indicated as dotted gray\nabout the strata probabilities.\nWhen the probabilities were equal, the method could not identify the correct map-\nping of the mixture components to the principal strata values because the model\nwas under-identified. Consequently, the maximum likelihood estimation was un-\nable to recover the model parameters.\nWe also examined the sensitivity of the four strata model to model misspec-\nification [Griffin, McCaffrey and Morral (2008)]. As expected, the method was\nsensitive to extremely heavy tailed and skewed distributions. The algorithm ap-\npeared to perform well when the data had only moderately heavy tails or moderate\nskew.\nUnfortunately, our simulation study results suggest that our results for the ATM\nstudy must be interpreted with caution. While the dispersion of means within each\nlevel of institutionalization in the ATM data is 3.04, the effective sample size in the\nweighted control group is quite small, only 125, drawing into question the ability\nFIG. 5. Simulation results. Plot of fitted means (black dots) versus true values (indicated by dashed\nlines) for the four strata in the treatment group with means for other strata (indicated as dotted gray\nabout the strata probabilities.\nof this model to converge to the correct solution if the principal stratification model\nholds in our data.\nOur simulation study analysis was repeated for a nine strata model in which Zt\ncan take on three values, namely, 0,1 and 2. However, a number of problems were\nencountered. First, the number of possible sets of starting values (e.g., mappings\nbetween the parameters of the full model to estimates from simple mixture models\nfit to data) increased significantly, leading to 2192 possible sets of starting values.\nGiven the computational demands of such a large number of starting values, we\ndid not run the EM algorithm for all possible mappings. Instead we calculated\nthe likelihood at each possible mapping and then tried two techniques for select-\ning reasonable starting values: (i) choosing the 30 starting values which gave the\n30 greatest values of the log-likelihood and (ii) choosing the 30 starting values\nwhich represented a spread of the log-likelihood surface. We found that option (i)\nFIG. 6. Simulation results. Plot of fitted probabilities (black dots) versus their true values (indicated\nand different assumptions about the strata probabilities.\nyielded the best solution (i.e., the solution which gave the highest value of the log-\nlikelihood). However, even with a dispersion of means equal to 2.5 and N = 5000\nper treatment arm, the best solution from option (i) was unable to recover the model\nparameters used to simulate the data (results available upon request).\nIt is likely that adding more parametric assumptions into the nine strata model\nwould help improve the fit of the model. For example, one could consider mod-\neling the means within each stratum and treatment group as a linear function of\nthe value of Z1 and/or Z0. However, as the number of strata increases, more as-\nsumptions will be required which may or may not be likely to hold in practice. In-\nevitably, extending principal stratification to more strata becomes intractable and\nunidentifiable beyond the simple four strata model.\n5. Discussion. Institutionalization during the follow-up poses serious chal-\nlenges to estimating treatment effects on outcomes following substance abuse\ntreatment because it restricts opportunities to use drugs or partake in other prob-\nlem behaviors (e.g., criminal activity or risky sexual activity). If unaccounted for,\nit can confound treatment effects and lead to incorrect inferences about the ability\nof treatment to produce desirable outcomes. Similar problems can occur in many\nother settings, such as criminal justice and mental health outcomes studies where\nstudy participants are also at high risk for institutionalization during the follow-up\nperiod.\nBecause institutionalization occurs post-treatment, treating it as a covariate in\nanalyses can lead to biased results since cases with various levels of institutional-\nization might differ in terms of their potential outcomes [McCaffrey et al. (2007)].\nMost common approaches to the problem require strong assumptions and the re-\nsults can be very sensitive to which assumptions are made and which methods are\nused [McCaffrey et al. (2007)]. For example, use of a joint or composite outcome\nwhich looks at the effects of treatment on institutionalization and SFS together\nconflates the effects that treatment has on institutionalization with the effects it\nhas on SFS. Principal stratification allows us to directly model how the treatment\neffects on SFS may vary within different levels of institutionalization.\nPrincipal stratification provides a framework for developing causal effects on\noutcomes in the presence of post-treatment institutionalization. The key idea is\nthat causal effects can be obtained by conditioning on cases with equal values for\nthe observed level of institutionalization for the observed treatment status and the\nunobserved level of institutionalization for the unobserved treatment status. In sit-\nuations where institutionalization can take on discrete values, the latent principal\nstrata result in finite mixture models and the parameters of interest can potentially\nbe estimated. When applied to adolescent substance abuse treatment data in the\nATM study, the method suggests that residential treatment may be less effective\nfor youth who are likely to experience the same level of institutionalization un-\nder both conditions (residential and outpatient). However, the effect is strongest\namong those youth who are unlikely to be institutionalized following treatment--\nthat is, the least problematic users. Alternative analyses [McCaffrey et al. (2007)]\nfound a similar result which improves our confidence in these findings, despite the\nchallenges of the method cited above.\nAs discussed in the Introduction, stakeholders, like parents, want to know if\ntreatment is effective and for whom it is effective. The principal stratification ap-\nproach estimates causal effects for youth in different principal strata. Thus, we aim\nto know if treatment is effective for youth within each principal stratum where in-\nstitutionalization is constant across treatment conditions. However, the principal\nstrata do not necessarily provide meaningful classification of adolescents to stake-\nholders. An important follow-up to our analysis is to determine if principal strata\nmembership can be described using measurable and meaningful baseline variables\nso that stakeholders might have a better idea about which youths will be best served\nby treatment or different treatment modalities.\nBeyond this application, our investigation of principal stratification suggests\nthat the potential of principal stratification may be impossible to realize in many\nempirical studies. Our study shows that the differences in outcome means among\nthe principal strata must be quite large (1.6 standard deviation units or larger)\nand that the sample sizes must also be very large (N  1000) for estimated ef-\nfects to correctly identify which means belong to each principal stratum. Unfortu-\nnately, such dispersion of means and sample sizes are much greater than those that\nare likely to arise in many applications. With smaller samples sizes and less dis-\npersed means, group labels are often switched; for instance, the means of the Z1\n=\n= 0 stratum might be incorrectly labeled as the means for the Z1\n= 0, stratum yielding incorrect inferences about treatment effects. Addition-\nally, the switched mean values may be very plausible so that there would be no\nindication of misleading results. The limitations of principal stratification must be\nconsidered carefully before using the method in all but the most ideal settings.\nAs the possible values for institutionalization grow, the problem quickly be-\ncomes more unmanageable. The number of parameters for the principal strata\nand the number of mixtures that need to be identified grow rapidly; even finding\nstarting values becomes an extremely challenging task as the possible values for\ninstitutionalization grow. Estimation in these contexts will require additional as-\nsumptions about the relationship between outcome and institutionalization (e.g.,\noutcomes decline linearly with increased institutionalization) and assumptions\nabout the joint distribution of institutionalization under treatment and control to\nmake the problem more tractable.\nGiven the challenges of principal stratification when we consider many values\nfor institutionalization, a possible option may be to ignore the outcomes from in-\nstitutionalized cases and try to estimate an unsuppressed treatment effect restricted\nto cases that would not be institutionalized under either treatment or control. Our\napproach to starting values could be used and trustworthy estimates might be ob-\ntained in some real world settings. The limitation of this approach would be the\ninability to generalize the estimates beyond cases that are likely never to be insti-\ntutionalized. That is, we could not estimate the unsuppressed effect for all cases\nnor could we determine treatment effects on institutionalized youth.\nUsing a Bayesian approach might address some of the computational problems\nwith maximizing the likelihood since integrating over a prior helps to reduce sen-\nsitivity to the starting values. However, special care would be needed when us-\ning Markov chain Monte Carlo methods to sample the posterior to avoid label\nswitching of the mixtures within the observed values of institutionalization [Jasra,\nHolmes and Stephens (2005)]. Strata label switching will occur because the data\nprovide only very indirect information about the joint distribution of potential in-\nstitutionalization. Use of an informative prior would be one means of overcoming\nthis limitation of the data via Bayesian analysis. However, this approach is unap-\npealing because analysts are unlikely to be able to make good informed guesses\nabout the joint distribution so that informed priors would be difficult to choose.\nObtaining sufficient information about the joint distribution of the potential in-\nstitutionalization outcomes is a clear challenge to using the framework of principal\nstratification to provide useful estimates of treatment effects. One approach to ob-\ntaining more information about this distribution would be to collect data at base-\nline that might be strongly related to the principal strata and use the information\nas covariates in the model for the strata probabilities. For institutionalization fol-\nlowing substance use treatment this information might include criminal activity,\ndetailed information about involvement with the criminal justice system, history\nwith substance abuse treatment, the availability of various types of substance about\ntreatment and sources of payment for the treatment.\nAnother approach for increasing the information about the principal strata is to\njointly model multiple outcomes such as multiple indicators of substance use and\ncriminal activity. Because principal strata are defined by institutionalization and\nnot by other outcomes, principal strata designation should not depend on which\noutcome is modeled. Combining multiple outcomes can therefore provide more\ninformation about the latent principal strata membership and should improve es-\ntimation of treatment effects for every outcome. A downside of this approach is\nthe necessity of specifying the joint distribution for multiple outcomes, but the ad-\nditional modeling might be very beneficial for identifying the principal strata and\nthe accuracy of the resulting treatment effect estimates.\nWe might consider simply using the principal stratification framework for sen-\nsitivity analyses. For example, rather than trying to model the joint distribution of\nZ0 and Z1, we might specify the joint distribution in terms of the parameters of the\nmarginal distributions of Z0 and Z1 and a parameter specifying their correlation.\nThe value of the correlation parameter could be manipulated to study the sensi-\ntivity of the treatment effect estimates to different assumptions about the principal\nstrata. For example, when institutionalization can take on just two values, we could\nspecify the correlation by the interaction from a log-linear model. For continuous\ninstitutionalization, we could specify the correlation parameter.\nPrincipal stratification is an important tool for approaching the problem of insti-\ntutionalization during the follow-up, because it provides a framework for defining\nestimates of interest and possible methods for estimating them. However, it is also\nclear that it is not a panacea to the problem because the model parameters are at\nbest weakly identified and it does not extend easily to problems with many possi-\nble values for institutionalization. The extensions described above provide useful\nareas for future research that may significantly improve the application of principal\nstratification in real world settings.\n"
}