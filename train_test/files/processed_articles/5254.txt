{
    "abstract": "Abstract\nGeneric red, green, and blue images can be regarded as data sources of coarse (three bins) local\nspectra, typical data volumes are 104 to 107 spectra. Image data bases often yield hundreds or\nthousands of images, yielding data sources of 109 to 1010 spectra. There is usually no calibration,\nand there often are various nonlinear image transformations involved. However, we argue that\nsheer numbers make up for such ambiguity. We propose a model of spectral data mining that\napplies to the sublunar realm, spectra due to the scattering of daylight by objects from the generic\nterrestrial environment. The model involves colorimetry and ecological physics. Whereas the\ncolorimetry is readily dealt with, one needs to handle the ecological physics with heuristic\nmethods. The results suggest evolutionary causes of the human visual system. We also suggest\neffective methods to generate red, green, and blue color gamuts for various terrains.\n",
    "reduced_content": "Article\nColors of the Sublunar\nJan Koenderink\nJustus Liebig Universita\n\u00a8t Giessen, Germany; University of Leuven\n(KU Leuven), Belgium; Utrecht University, the Netherlands\nAndrea van Doorn\nJustus Liebig Universita\n\u00a8t Giessen, Germany; Utrecht University,\nthe Netherlands\n Keywords\nnatural colors, ecological optics, opponent channels, spectral correlation\nMotivation\nWe consider the colors of essentially the sublunary sphere of Aristotelian physics (itself\nderived from Greek astronomy). The sublunar region comprises the four classical elements\n(earth, air, fire, and water), the part of the cosmos where physics rules, the realm of changing\nnature. Nowadays, we might say ``the natural environment.''\nDigital photographs capture spectral information in a format that is closely related to the\nhuman visual system. This implies that the red, green, and blue (RGB) channels roughly\ncontain counts of low-energy, medium-energy, and high-energy photons within the narrow\nvisual range (about 1.8 to 3.4 eV). Enormous numbers of photographs from around\nthe globe, each containing millions of spectral samples are readily available over the\nInternet. It would be a shame if such spectral data could not be mined and put to good use.\nCorresponding author:\nJan Koenderink, Laboratory of Experimental Psychology, University of Leuven (KU Leuven), Tiensestraat 102, Box 3711,\nEmail: koenderinkjan@gmail.com\nCreative Commons CC-BY: This article is distributed under the terms of the Creative Commons Attribution 4.0 License\n(http://www.creativecommons.org/licenses/by/4.0/) which permits any use, reproduction and distribution of the work without\nfurther permission provided the original work is attributed as specified on the SAGE and Open Access pages (https://us.sage-\npub.com/en-us/nam/open-access-at-sage).\ni-Perception\njournals.sagepub.com/home/ipe\nHowever, there are numerous hurdles to be taken in order for this to be possible. We consider\nhow to overcome some of them.\nIn order to motivate our methods, we start with a cursory look at the modest data source\nshown in Figure 1. The data volume is about 5 \u00c2 106 samples. The average RGB color is\nHowever, this optimistic guess is immediately shown to be wrong from a cursory glance at\nthe covariance matrix, which is\nB\n@\nC\nwhere we have scaled the largest entry to 100. Clearly, the RGB color channels are highly\ncorrelated. As shown in following sections, this is entirely typical of photographs from the\nthus, the dominant dimension carries 40 times the power of the other two combined. The\nthird dimension carries only a 10th of the power of the second one.\nThese correlations must be due to the width of the autocorrelation function of the radiant\npower spectra of the natural (sublunar) environment. We consider this in some detail in this\narticle. The RGB color channel correlations have immediate consequences that are\nimportant. Here we illustrate some of these, continuing our discussion of the pebbles image.\nThe eigenvectors are very close to the normalized versions of {1, 1, 1}, f1, 0, \u00c01g, and\nf\u00c01, 2, \u00c01g, as shown in Figure 2. Such an ``opponent'' basis effectively decorrelates the\nRGB channels. The opponent channels are white\u00adblack, red\u00adblue and green\u00adpurple.2 They\nhave an obvious interpretation in terms of physics, as discussed later.\nThe fact that ``opponent channels'' serve to decorrelate color-related signals, such as the\nRGB, has been known for a long time. However, this insight came from analysis of the color\nmatching functions (Buchsbaum & Gottschalk, 1983), that is to say, the structure of the\nhuman visual system. Here we have a quite different perspective; the correlations between\nthe RGB channels are correlations between subregions of the radiant power spectra of the\nsublunar realm. We do not consider the human color system, but rather the ecological optics,\nFigure 1. Pebbles image.\nthat is, environmental physics. This does not address the vision of any specific species. Of\ncourse, we will come back to human color vision in this article, but only by way of a detour:\nNo doubt, human color vision evolutionary adapted to the environmental physics.\nTwo facts are important here. First, a default prior yields very different results. Second, as\nwe will show later, just about all photographs deriving from the sublunar domain have\nessentially the same structure as that of the arbitrarily picked pebbles example (Figure 1).\nWhy is that? This appears to be a key question from an evolutionary perspective.\nThe first fact results immediately from elementary probability calculus. Suppose the RGB\nchannels are mutually independent and uniformly distributed on the interval \u00bd0, 1. This\nappears to be a rational default assumption that also happens to optimize the channel\ncapacity. Then the normalized covariance matrix will be the unit matrix and the\neigenvectors (except from being mutually orthogonal) essentially unconstrained. All\ndimensions will carry an equal share of the power. But this apparently reasonable ``default\nassumption'' is totally in the wrong ballpark.\nThe second fact is less easy to understand. It evidently involves the ecological physics of\nthe sublunar realm. Accounting for this observation is a hard problem that can only be\napproached in a rather roundabout and approximate manner. It is dependent on the\nmeaning of ``ecological,'' which not only involves the physics of the environment but also\nthe structure of the human visual system.\nIn this article, we propose a model of spectral data mining that applies to the sublunar\nrealm, involving spectra that are mainly due to the scattering of daylight by objects from the\ngeneric terrestrial environment. The model necessarily involves both colorimetry and\necological physics. The colorimetry is readily dealt with using standard tools. Because of\nthe huge variety and complexity of the sublunar, the ecological physics has to be approached\nthrough heuristic, approximate methods of great generality.\nFigure 2. The blue vectors are f1, 0, \u00c0 1g=\nffiffiffi\np\nffiffiffi\np\nffiffiffi\np\nand the red vectors are\nthe eigenvectors of the pebbles image. The pole is the f1, 1, 1g=\nffiffiffi\np\ndirection. Note that the pebbels\neigenvectors are really close to the fiducial ``opponent system.''\nKoenderink and van Doorn 3\nThe results yield handles on the evolutionary causes of the structure of the human visual\nsystem.\nThe methods described here also yield effective methods to generate RGB color gamuts for\nvarious terrains, something that might find a variety of applications.\nPsychophysical, Physiological, and Physical Backgrounds\nAlthough we consider these backgrounds separately, they are evidently closely connected,\nbecause humans have been shaped by evolution to match their generic Umwelts.3 Because we\nare not considering visual awareness, but only discriminability, the visual part is readily dealt\nwith using well known and standardized colorimetry. The physical part is far more involved.\nPsychophysical and Physiological Background\nThe human observer samples a linear projection of the radiant power spectra available at the\neyes. The complement of the projection's null-space is three dimensional for the generic\nhuman observer. The null-space of the generic projection is well known, it was established\nempirically in the 19th century by Maxwell and Helmholtz (Koenderink, 2010a).4 Nowadays,\na projection matrix is available on the Internet. There is no natural basis for ``color space,''\nthat is the complement of the null-space, nor is there a natural metric.\nWe consider a highly simplified model of the sublunar realm in which the radiant spectra\nare spectrally selectively attenuated versions of the daylight spectrum. This implements\n``object colors.'' For simplicity, we use a standard daylight spectrum available for\ndownload on the Internet (www.cie.co.at/index.php/LEFTMENUE/DOWNLOADS; see\nFigure 3).\nThe colors of such attenuated daylight spectra fill a finite region in color space. Because\nthe daylight spectrum defines an infinitely dimensional cuboid in the space of spectra, this\nregion is a convex, centrally symmetric volume in color space.5 Its structure has been\ndescribed by Schro\n\u00a8 dinger (1920). Colors on the boundary of this ``color solid'' are proper\n``parts of daylight'' in the sense that their spectra are characteristic functions of connected\nspectral ranges or complements thereof.\nFigure 3. At left, the CIE illuminant D65 (average daylight). The colors show the spectral bins for the cut-\nloci 483 nm and 565 nm. At right, the color matching functions of the CIE 1964 supplementary standard\ncolorimetric observer. The tables may be downloaded from the CIE site, the cut-loci can immediately be\ncomputed from them.\nThis can be used to find the nature of spectral sampling by the human visual system. Split\nthe spectrum into three parts by way of two cuts. Place the cuts thus that the resulting RGB\nspace claims the largest possible volume fraction of the full Schro\n\u00a8 dinger color solid. This is a\nwell-defined optimization problem because volume ratios are invariant against arbitrary\ncolorimetric transformations. One finds (numerically, using the CIE color matching\nfunctions shown in Figure 3 right) that there is a unique solution, and the cuts should be\nfor color space. The convex hull of the basis vectors is the parallelepided of largest volume\nthat can be inscribed in the color solid, making it the optimum RGB basis (Figure 4 right).\nThe corresponding color matching functions (Figure 4 left) are predominantly nonnegative\nand are mutually only weakly correlated.6\nPhenomenologically, the resulting parts look red, green and blue to generic observers,\nwhereas unions of two parts look yellow, turquoise, and purple and the union of all three\nparts looks white.7 Thus, one has a true RGB representation, exactly what display\nmanufacturers aim for. If a display deviates significantly from this optimum, it is unlikely\nto attract customers. The reason is simply that the physiology dictates it.\nOf course, there is no necessity for display manufacturers to produce ``parts of\ndaylight'' as such. For display purposes, they are already in good shape when they get the\ncolors--not necessarily the spectra--right. Thus, one might even use (quasi-)monochromatic\nsources. In practice, the spectra will often derive from the electronic structure of rare\nearth elements, from various organic molecules and so forth and often be rather\nrough. Nevertheless, the gamuts of current display units approximate that of the parts of\ndaylight.\nThe same does not apply to the sensors. Ideal sensors would implement the human\nprojection (Figure 4 left). The parts of daylight would be a good choice that is\napproximately physically possible because the sensor sensitivities should be nonnegative\nthroughout most of the spectrum. Of course, such an ideal cannot be achieved. In\npractice, one makes do with coarse approximations. This typically involves a mosaic of\nabsorption filters in front of the CCD or CMOS photosensitive chip. Fortunately, this\nFigure 4. At left, the color matching functions for the parts of daylight RGB colors. At right two (mutually\nsymmetric) halves of the surface of the Schro\n\u00a8dinger color solid. The skeleton cube is the parallelepided\nspanned by the red, green, and blue parts of daylight. This is a straight calculation from the CIE tables. The\nRGB cube snugly fits the color solid, in practice the overwhelming majority of object colors lies in the cube.\nThis is the theoretically optimal representation of RGB colors.\nKoenderink and van Doorn 5\ntends to work out fine because almost all spectra of interest are not highly articulated. This is\na topic to be discussed in the next section.\nThis suggests that human physiology effectively implements hyperspectral imaging with\nwhere--in practice--``0'' is really somewhat like 380 nm and ``1'' somewhat like 700 nm.\nThe effective visual range subtends hardly an octave.8 Of course, the precise locations of the\nbin boundaries depend upon the daylight spectrum and the color matching functions. From a\nbiological perspective, the key role of the daylight spectrum in setting up the RGB basis\nmakes good ecological sense. The color matching functions are expected to be evolutionary\ntuned to it, indeed, various suggestions have been proposed in the literature.\nThis spectral description in terms of three bins is a natural RGB system, to which the camera\nand display industries have to comply--of course, approximately and by various heuristics. In\npractice, one notices that displays have largely converged, whereas there is quite a bit of\nvariation among sensor sensitivities. That is why the ``color rendering'' of cameras tends to\nbe debated in websites reviewing the latest consumer cameras. However, to the first\napproximation, all cameras are very similar, or they would not attract any customers at all.\nThis is essentially all the colorimetry needed in this article. Note that we do not refer to\nqualities of visual awareness, nor to just noticeable differences and so forth.\nPhysical Background\nThe physics is rather more involved. In order to avoid unfortunate confusion, it is necessary to\ndistinguish between the spectrum of radiative power (henceforth called RP spectrum) and the\nspectrum of the articulation of the RP spectrum (henceforth called SA spectrum). The SA\nspectrum is the Fourier transform of the envelope of the RP spectrum. It can be quantified in\nterms of cycles per octave of the RP spectrum (Koenderink, 2010a). Both the amplitude and\nphase of the SA spectrum are relevant.\nFrom the perspective of physics, the visual range subtends only a narrow window of the\nelectromagnetic radiant power spectrum (about 380\u00ad700 nm as mentioned above). This is\nhighly relevant from an ecological perspective, for the physical causes of spectral articulations\nchange categorically over the electromagnetic spectrum (Feynman, Leighton, & Sands, 1963\u00ad\n1965). Molecular rotation bands occur in the infrared spectrum, while effects of electronic\ntransitions in atoms occur in the ultraviolet spectrum. Articulation in the visual range is\nlargely due to processes involving chemical binding energies. Since the set of physical\ncauses is the same over the visual range and the width of the range is only an octave, the\nrange will be statistically uniform. For spectral articulation, the important processes may be\ntaken as translationally (along the wavelength axis!) invariant. This implies that a spectral\nanalysis (the SA spectrum) makes sense. The articulation can have a variety of causes, there\nappears to be no particular absolute dimension. Thus, the default assumption would be scale-\ninvariant (or self-similar) spectral statistics (Chapeau\u00adBlondeau, Chauveau, Rousseau, &\nIt is hard to put this to an empirical test. Estimates of the SA spectra for a small number of\nrather narrowly focused databases appear to confirm the notion. However, one is stuck with\nan annoying lack of data (Kohonen, Parkkinen, & Jaa\navailable data appears to conform to expectations though. Some examples can be found in\nPerhaps surprisingly, these simple notions are already sufficient to draw some\nimportant consequences. Given that the visual range is narrow and its structure translation\ninvariant, one expects the covariance matrix of the RGB color channels to have a structure\nroughly like\nB\n@\nC\nare positive and (typically much) smaller than 1, whereas--because covariance\nwill be a monotonic function of spectral separation--one expects \"1 % \"3\nto be\nsignificantly larger than \"1,3\n. This approximate form is expected because there is no reason\nwhy the color channels should be distinguished, the covariance should only depend\nmonotonically upon spectral distance9 (Koenderink, 2010b). Indeed, letting the data speak\n(section ``Let the data speak'') fully bears this out.\nFor simplicity, we consider the case \"1 \u00bc \"3 \u00bc \", \"2 \u00bc 2\" as an illustration. To the lowest\nrelevant order in \" (zero or one), the eigenvectors of CRGB\nare\nffiffiffi\np\nB\n@\nC\nffiffiffi\np\nB\n@\nC\nffiffiffi\np\nB\n@\nC\nand the corresponding eigenvalues proportional to 1, 2\n\". These eigenvectors are\nsimilar to white\u00adblack, red\u00adblue, and green\u00adpurple ``opponent'' channels as originally\nproposed by Hering (1920) on phenomenological grounds.\nThe first eigenvalue strongly dominates. It carries Z \u00bc 9=\u00f08\"\u00de times the power of the other\ndimensions combined. This ratio Z is a useful characteristic number that is easy to derive\nfrom image databases, and it will be used in the section on data mining (section ``Let the data\nspeak''). It tends to be significantly larger than one (about three to thirty in practice). Note\nthat the higher the Z, the closer the images are to being effectively monochrome. In almost all\necologically relevant cases, the first eigenvalue so strongly dominates that it will typically\nmake sense to treat the second and third dimensions as essentially independent of the first\none. These two eigenvalues are seen to be in a fixed ratio (here three).\nThis rough analysis is interesting in view of the significant literature on principal\ncomponent analyses of collections of empirically determined spectral reflectance factors\ninvariably similar to the eigenvectors derived above (further illustrated below), there is\nessentially no valid reason to go through the trouble of measuring them and there is little\nreason to expect differences for various collections of samples. Indeed, there are not.\nThe minor differences reported are probably due to the necessarily (very) limited size of\nthe samples, which is perhaps an additional reason to prefer a fixed, formal basis.\nThe reason for the prominence of the two (instead of three11) opponent-like eigenvectors is\nthat they implement the first- and second-order derivatives of the SA spectrum (see below).\nThus, these opponent channels represent the structure of the SA spectrum at a point. This also\nexplains why they are mutually independent, it derives from the independence of derivatives\nof noise signals (such as the SA spectrum) of even and odd order (Longuet\u00adHiggins, 1957).\nThis analysis, indeed, accounts for the major traits of the empirical data is illustrated by\nthe simulations presented in Appendix A.\nThe physics of ``object colors''. Object colors are due to radiant spectra that largely result from\nthe scattering of radiation--here to be taken as average daylight say--by solids. Generic\nKoenderink and van Doorn 7\nexamples are colored papers, fabrics, human skin, soil, and rocks, . . . There are various\nprocesses that may play a role.\nAn important process is the radiative transport in layered turbid media. A well-known,\napproximate model is the Kubelka\u00adMunk theory of turbid layers (Kubelka & Munk, 1931).12\nIt is an approximate treatment of the radiative transport in layered turbid media that is very\nsuccessful in applications and widely used in the paint, paper, and so forth industry. We\nintroduce it here as a heuristic aid.\nThe key expression of the Kubelka\u00adMunk analysis is\n\u00bc  \u00bc\nK\nS\n \nis the reflectance of an infinitely thick layer, K is the specific absorption cross-\nsection, and S is the specific scattering cross-section. Solving for R1\nyields the inverse\nrelation\n\u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nq\n\u00c0  \u00bc F \nThe function F\u00f0\u00de maps between the nonnegative reals \u00f00, 1\u00de and the unit interval (0, 1).\nFrom a global perspective, the structure of the Kubelka\u00adMunk result is that the\nnonlinear part of the theory is packaged in the left side of Equation (4), whereas\nthe right side of this equation describes fundamental physical causes--responsible for the\nspectral articulation--which are dominated by linear processes. We use these observations as\na heuristic.\nIn ecological optics, one really does not have explicit theories; rather, a possibly large\nnumber of mutually different processes is likely to play some role. There is a need to capture\nthis in a general, overall way. Here, one may take a lead from the formal structure of the\nKubelka\u00adMunk equation (though not necessarily the explicit Kubelka\u00adMunk theory itself).\nThat is what will be attempted here.\nThe scattering and absorption cross-sections are nonnegative physical quantities for which\nthere exists no preferred absolute scale. Thus their noninformative Jeffreys' prior distribution\nMoreover, the quantities K and S are mutually uncorrelated. Thus, the parameter  (the ratio\nK/S) also has the hyperbolic prior.\nThe physical parameters combine multiplicatively, rather than additively, so a logarithmic\nrepresentation is a natural one for the statistics.\nA convenient way to capture this is to define a transformation  from the full real line R\n(on which the ``physical parameters'' are uniformly distributed) to the unit interval I (the\nobserver intensities in the RGB channels, taking values between zero and one) and back. For\nconvenience, one may use the pair\n\u00f0x\u00de \u00bc\n\u00f01 \u00fe tanh x\u00de  : R \u00b0 I \u00f06\u00de\nand\nbecause these transformations have fast implementations on most computing platforms. This\nis important since they may have to be applied a hundred million times in some typical\nexample. From a general point of view about any sigmoid shaped function, such as\n\u00f01 \u00fe erf\u00f0x\u00de\u00de=2 and so forth, would serve as well.\nNote that the cases \u00c01\u00f00\u00de \u00bc \u00c01 and \u00c01\u00f01\u00de \u00bc \u00fe1 are always to be avoided for\ntechnical reasons since the boundaries of the interval tend to accumulate physically\nmeaningless observations due to under or overexposure.\nIn practice, one transforms observations on the unit interval to the ``physical domain''\n(the full real line), does some calculations, and transforms back. It is an instance of the\nso-called homomorphic filtering (Oppenheim, Schafer, & Stockham, 1968), where the\nobservations and calculations take place in distinct, appropriate domains. In our\ncase, we collect data in the observation domain and study its statistics in the physical\ndomain; in other applications, one generates artificial data in the physical domain\nand studies it in the observation domain. Examples follow below. It is a way to avoid\nnonlinear unpleasantness cheaply.\nThe physics of the imaging process. In the case of imaging, one may use a formally very similar\nphenomenological model (Barrett & Myers, 2003).13 Here, the radiances in the scene are\nmapped on the unit interval for each of the color channels. When log radiance is mapped\nwith the function , the parameters are usually termed ``exposure'' (the location) and\n``contrast'' (the width). Such a mapping is usually followed with a ``gamma\ntransformation'' (Poynton, 2003), for example, r \u00b0 \u00f0r=r0\u00de\n with \n 4 0 and not to different\nAlthough perhaps surprising at first blush, it makes intuitive sense that RGB photographs\nshould retain the signature of the articulation of the radiative power spectral envelope, at\nleast in some coarse fashion. If it was not the case, the images would not be acceptable to\ngeneric viewers. A formal calibration is not required, but typically one should be able to judge\nthe distinction between red and green image details from the relative magnitudes of the RGB\nchannels.\nOf course, there are a variety of other factors that might put the value of potential ``data''\nin jeopardy. The transformations considered above also handle the spatial nonuniformity,\nsuch as the focal plane illumination fall-off of generic cameras. The major remaining source\nof worry is probably transverse chromatic aberration. Fortunately, it is not too prominent (at\nleast after correction by the in-camera firmware) in most contemporary camera models. It is\nunlikely to have an important effect on the statistics anyway, since it occurs at linear features,\nwhereas the bulk statistics derives from areas.\nA Phenomenological Ansatz. In the present application to the colors of the sublunar, the data\nare the color channels of images obtained by some familiar process (CCD or CMOS\ncamera using RGB Bayer pattern say) and distorted for visual display (the Internet say).\nThere are no radiometric calibrations. It is a very roundabout and most likely distorting way\nto observe physical parameters in the scene. Only by considering relations between relations\none can expect to zoom in to relevant structure, absolute values cannot be expected to\nbe informative.\nSuppose the ``true'' radiometric signals in some specific case were {r, g, b}. Let the display\ndistortion apply different magnifications fAr\n, Ag\n, Abg (say) and different gamma corrections\nf\nr\n, \ng\n, \nb\ng (say) to the color channels, so one observes \u00f0Ar\nr\u00de\nr instead of r, and so forth. Does\nthis have a major impact on the observed covariance structure? The question is most\nconveniently answered through a simulation. With \nmagnifications in the range \u00f00:5, 1:5\u00de, which is a wide range for typical ``corrections,'' the\nKoenderink and van Doorn 9\nthe covariance structure of the color channels easily survives maltreatments as one expects\nthem for images retrieved from the Internet.\nMore generally, monotonic transformations due to a variety of physical factors are\nunlikely to have much effect. This is perhaps intuitively reasonable given the fact that at\nleast rank order correlations are not sensitive to such factors at all.\nThe physics may be statistically modeled by a normal distribution on the logarithmic scale,\ncharacterized by location and width, for some physical parameter % (say) in analogy to the \nparameter of the Kubelka\u00adMunk theory. A highly schematic model of the generalized physics\nmight be a sigmoid function , mapping the log % domain on the unit interval. This leads to\nreflectances whose distribution depends on two parameters. Depending on the values of the\nparameters, one obtains histograms that are unimodal and skewed to either zero or one, or\nhistograms that are bimodal with peaks at zero and one (see Figure 5). This is indeed very\nsimilar to what is encountered in empirical data. Such a schematic model of the generic\nphysics captures the essential structure. (Kubelka\u00adMunk theory being one illustrative\ninstance.) The two parameters have to be estimated from empirical data, for this is a\npurely phenomenological model.\nLet the Data Speak\nEven a medium-sized image14 contains many pixels, for instance a 512 \u00c2 512 image contains\nmore than a quarter million pixels (262, 144 pixels). Thus, it is often possible to obtain useful\nstatistics from a single image. On the other hand, the typical RGB image uses byte encoding,\nFigure 5. Example of histograms in the observation domain due to normal distributions of various means\nand variances in the physical domain. Note that these are far from normal in the observation domain.\nat most fill 1.6% of the bins with one sample each. In order to have an average bin content of\na hundred one needs more than 6,000 of such images.\ndigital camera, 16Mp). For a typical field of view of 50, a pixel averages over 1\u00ad2, down to\n1\u00ad0.50. In terms of linear size, one needs to multiply with the distance, which typically ranges\nfrom arm's length (immediate environment) to many miles (landscapes). Thus, the relevant\nphysics might be mutually very diverse for the pixels.\nAs an example of single image statistics, we proceed with the image of pebbles (Figure 1).\nIt is a medium-sized image, it measures 2736 \u00c2 1824 pixels (thus about 5 Mp). The image is\nJPEG compressed, thus contains numerous artifacts on the local spatial scale. The overall\nmean RGB pixel value is {50, 46, 45},15 thus somewhat skewed towards the red, but\napproximately a median gray, as expected.16 We already reported the covariance of the\nraw {r, g, b} values.\nAs a first operation, the RGB channels are transformed to %, or ``physical space'' (using\nthe function \u00c01). The normalized covariance matrix becomes\nC% \u00bc\nB\n@\nC\nIt has a very similar structure as found for the raw values (Equation (1)). What has\nchanged are the distributions. The raw {r, g, b} values have histograms that may vary a\nlot, whereas the transformed values are close to being normally distributed. The\ntransformation\n\u00c3\n\u00c2\n\u00c4\nB\n@\nC\nA \u00bc T\n%\n\n\nB\n@\nC\nA, where T \u00bc\nB\n@\nC\nfinally yields the parameters f\u00c3\u00c2\u00c4g that will be used in the analysis of the data. These\nparameters are nearly decorrelated and the first one, \u00c3, strongly dominates. Indeed, one\nfinds (here normalized on a maximum coefficient of 1,000)\nB\n@\nC\nThe various covariance matrices thus have pretty much the form expected from first\nprinciples. Thus, already from a single image, the major aspects of the sublunar color\ngamut are apparent. Note that the scene contains mainly diffusely scattering solids, no\nsources or metallic reflectors and so forth.\nFor this image Z \u00bc 24:6, as expected, much higher than unity. Since the \u00c3 channel\ndominates so strongly over the \u00c2\u00c4 ones, it makes sense to split the two. One uses the\nfraction of the variance captured by the \u00c3 channel as one observation and the\n(normalized) covariance matrix for the \u00c2\u00c4 plane as another. The \u00c2 channel accounts for\nalmost all of the remaining variance, which is entirely typical. Moreover, one has\n \n.\nKoenderink and van Doorn 11\nAn important gain of this transformation is that the % histograms in the ``physical\ndomain'' are much closer to normal than in the bare color channel domain. The \u00c3\nhistogram is close to normal too, whereas the \u00c2 and \u00c4 histograms look somewhat more\ncomplicated. Indeed, typically most of the idiosyncrasy of an image tends to be found in these\ncomponents.\nOf course, this is just a very small sample. Because a small sample, it is perhaps in danger\nof being atypical. For larger databases, the idiosyncratic nature of singular images tends to be\ndrowned in the crowd.\nMore extensive statistics is available from a variety of databases in the public domain.\nThe landscapes database from Torralba and Oliva at MIT (Torralba & Oliva, 2002) is an\nexample (Figure 6). It is an interesting case because it also allows a distinction between\nwhat is intended as ``sublunar'' here and what might be termed ``aerial,'' or\n``atmospheric.'' The database contains 410 ``open country'' images in total. All are\n256 \u00c2 256 pixels, 8 bit per RGB channel. The majority has a strip of sky on top and a strip\nof foreground at bottom (see Figure 7 left). In the analysis, the ``top'' was defined as the\nupper 64 rows of the image pixel array and the ``bottom'' as the lower 64 rows of the image\npixel array. Although obviously not exact, this certainly serves to split the data in a group\nthat is predominantly sky, or atmospheric and a group that is predominantly ``sublunar'' in\nthe intended sense of this article. This reduces the volume of the top and bottom sets to about\n6.7 Mp samples each.\nIndeed, simply averaging over all images in the database yields a ``generic landscape''\nimage that is brownish below and bluish on top. Many of the images include blue sky\n(Strutt, 1899). It is the kind of priming, which a landscape painter might use in\npreparation of a painting. The human visual system is also tuned to this type of color\nbanding (Koenderink, van Doorn, Albertazzi, & Wagemans, 2015).\nOf course, the averaging removes all local variety. The nature and extent of this variety is\nretained in sampled images (see Figure 7 right). Each instance of such a sampled image is\ndifferent, because pixel values are randomly sampled over the whole database, the only\ninvariant being location in the pixel plane.\nFigure 6. A mosaic composed of a subsample of the ``open landscape'' set of the MIT database.\nThe effect of the air\u00adlight (Koschmieder, 1924) is visible in the average image, both in the\nground plane and in the sky. The colors of the distant ground plane and the low sky become\nvery similar at the horizon (Middleton, 1952). Apparently, such facts of ecological physics are\nquite robust in the sense that they survive noncalibration and likely maltreatment of image\nprocessing. Large data speak so loudly that these problems are overcome in the statistics.\n28}. Thus, the bottom part indeed looks brownish on the average, the top part bluish. This is\nalso evident from the RGB histograms (Figure 8). Note that the histograms are far from\nnormal, as could hardly be expected otherwise.\nA transformation to physical space makes the histograms, although somewhat skew,\nappear much more normal. Of course, the precise form depends somewhat on the\nchoice of the sigmoid transfer function. The f\u00c3, \u00c2, \u00c4g values are nearly normally\ndistributed (Figure 8).\nThe differences between the sky and earth parts of the open landscape images are well\ncaptured by the means and standard deviations of the f\u00c3, \u00c2, \u00c4g parameters. One has\nSuch parcellated structure as in the open country database is quite typical for focused\ndatabases. As an example, the global mean of the Leeds butterfly database (762 images after\nremoval of the images of pinned insects from museum collections) clearly reveals a ``generic\nbutterfly'' (Figure 9). Such material is evidently unsuited to the present purpose. The same\ngoes for images that depict various mutually very different items. An example is the parrots\nimage (Figure 10). Not surprisingly, the \u00c3\u00c2\u00c4 histograms are far from normal here. Thus, the\nmethod of chromatic data mining as discussed here only makes sense for reasonably\nhomogeneous images or databases.\nHere, we show some examples aimed at various types of terrain, some based on fairly\nlarge, representative images, other on databases focused on particular topics. For more\ninformation on the databases, see Appendix B.\nAn image like the desert soil image (Figure 11) is obviously quite homogeneous. It is a\nFigure 7. Local mean (left) and local samples (right) for the open landscape database.\nKoenderink and van Doorn 13\nentirely standard, with Z \u00bc 8:3. The \u00c3\u00c2\u00c4 histograms are close to normal. Here, the analysis\napplies perfectly. The same applies to most images of landscapes selected for uniformity.\nDatabases tend to be less overall uniform, though this need not be much of a problem if\nthe fraction of ``outliers'' is small. As an example, consider the forest database (Figures 12\nand 13). Here, two distinct types of nonuniformity occur.\nFirst, there are outliers such as autumn foliage. Since these are true outliers, they are not\nproblematic due to sheer numbers.\nFigure 8. Histograms for the open landscape database. Top row for the observation domain and bottom\nrow for the physical domain (black: \u00c3, blue: \u00c2, and red: \u00c4). The left column relates to the lower (earth) part\nand the right column to the upper (aerial) part of the images.\nFigure 9. The Leeds butterflies database. At left some samples, at right the overall mean.\nFigure 12. Samples from the forest data base. It is very inhomogeneous.\nFigure 11. Desert soil image with its histograms in the physical domain (colors as in Figure 8).\nFigure 10. Parrots image with its histograms in the physical domain (colors as in Figure 8).\nKoenderink and van Doorn 15\nSecond, there is a systematic trend for blue sky intruding on the top part. Here, large\nnumbers do not help as can be seen from the global average. As a result the \u00c3\u00c2\u00c4 histograms\nappear as perturbed normal distributions. The only remedy is to cut off the top part of all\nimages.\nThere are evidently detectable differences in the available databases, although the overall\nstructure is quite invariant. This can be judged in the larger databases by sampling random\nsubsets. One finds that the statistical estimates for samples of say a hundred images (that is\nstill good for millions of pixels) are very stable and well determined. Since any sample from\none of the databases yields pretty much the same results, the databases have a unique\nsignature, despite their global similarity. This suggests that the description might have\nsome merit as a descriptor of the ``gist'' (Oliva & Torralba, 2006)--in colorimetric\nrespects--of a database.\nAs to be expected, the images one encounters are almost invariably normalized so as to be\noverall medium gray with maximum contrast. The overall RGB means scatter all about the\nachromatic point in a chromaticity diagram (Figure 14). A measure of the monochrome\ncontrast is the standard deviation in \u00c3. Empirically it varies over the range 0.65\u00ad1.38\ncamera range selections, thus essentially meaningless for ecological research.\nMeaningful measures are necessarily modulo \u00c3. For the examples analyzed in this article,\nmuch larger than the value expected for mutually independent, normally distributed with\nequal variance %, ,  channels. The number Z and the average value of \u00c3 are mutually\nuncorrelated, thus Z is a meaningful number.\nAs can be seen in Figure 15, the opponent channel frame indeed fits almost universally. In\nthis figure, the eigendirections of the \u00c3\u00c2\u00c4 covariance matrix have been plotted in a\nstereographic projection from the white point (thus f1, 1, 1g=\nffiffiffi\np\n). The first eigendirection is\nclosely centered on the origin, much as expected. The remaining two eigendirections are\nindeed strongly clustered and are close to the expected \u00c6f\u00c01, 0, 1g=\nffiffiffi\np\n(red\u00adblue opponent)\nffiffiffi\np\n(green\u00adpurple opponent). Thus, the data speak strongly in favor of\nFigure 13. Local overall mean and local samples from the forest database.\nHering's (1920) opponent system. These directions, thus, are strongly implicated by billions\nof spectral samples, there is no phenomenology of chromatic qualia involved.\nFor the data in Figures 14 and 15 (see Appendix B), we used a set of 5 large single images\nand 11 databases, some very large. The collection is very heterogeneous, for instance,\nFigure 15. Opponent color frame. These are stereographic projections of the sphere of eigendirections\nffiffiffi\np\n. The circle is the locus of orthogonal directions to f1, 1, 1g=\nffiffiffi\np\n. There is an\nobvious clustering along the ``opponent directions.'' The ellipses show the one and two standard deviations\nboundaries. The indices refer to the list of data sources (see Appendix B). In total, this figure is based on\nFigure 14. The overall RGB mean. The horizontal and vertical guidelines denote the one-third values, thus\ntheir intersection marks the point R \u00bc G \u00bc B. The ellipses show the one and two standard deviations\nboundaries. The indices refer to the list of data sources (see Appendix B). In total, this figure is based on\nKoenderink and van Doorn 17\nthe landscapes were not segmented into foreground and sky, the flowers and butterfly\ndatabases were used as is and so forth. It is interesting to see how the structure of all\nthese sets is rather similar although very different from the apparently obvious default\nassumption (mutually independent, uniformly distributed RGB channels).\nFor large samples, the pixel RGB data are largely captured by four parameters, describing\nthe level variability of the spectral articulation as described by \u00c2 and \u00c4. For smaller samples,\none encounters deviations from normality in the distributions of \u00c2 and \u00c4, sometimes finding\nbimodality, more typically heavy tails instead of normality. The \u00c2 and \u00c4 distributions\ncapture the spectral articulation, which will naturally vary from sample to sample when\nthe sample size is small.\nIt is a measure of the cool\u00adwarm contrast (Benson, 2000), the variation of spectral slope.\nIt is a measure of the moist\u00addry contrast (Benson, 2000), the variation of spectral curvature.\nThere is a high correlation (R2 \u00bc 0:72) between the standard deviation of \u00c4 and \u00c2\nwhich apparently is a characteristic universal constant for the sublunar realm.\nAlthough perhaps understood in retrospect (such a dependence is also predicted\nby Equation (3)), this is evidently a remarkable finding. Most of the variance is in the\nred\u00adblue, rather than the green\u00adpurple. This is due to the autocorrelation length of\nthe articulation spectrum. This general structure is easily reproduced through very\nsimple statistical models that capture the major facts of the ecological optics (see\nAppendix A).\nFigure 16. Correlation plot of the natural logarithms of the variances of the parameters \u00c2 and \u00c4 for the\nsame databases as mined in the previous two figure. The regression line has slope close to unity, indicating a\nlinear dependence. The indices refer to the list of data sources (see Appendix B). In total, this figure is based\nAlgorithmic Generation of Sublunar Color Gamuts\nAn obvious method to obtain random instances of a color gamut defined by some database is\nto simply randomly sample from the database. No generic algorithm needed! However, this\ninvolves sampling randomly from hundreds, perhaps thousands of images and randomly\nsampling pixels from these.\nThis may well be a viable method if the data source is a single, large image. However, in\nmost cases, an algorithmic synthesis is the only practical way to proceed. It may well be the\npreferred way too, since it enables the possibility to automatically skip the unavoidable effects\nof saturation and subthreshold samples.17\nSince the structure of the sublunar color gamut is well determined and quite simple, it is\neasy to construct a random generator that will yield as many samples as desired for most\npurposes. All that is needed is to generate artificial \u00c3\u00c2\u00c4 triples. Free parameters--within\nreasonable bounds--are the variances and the nature of the histogram. For a global random\ngamut generator, one may assume normal distributions of all channels in the physical\ndomain.\nIt is perhaps most natural to generate the values in the physical domain. Then there are six\nfree parameters, namely, the location and widths of the physical values of the three channels.\nThus, the algorithm becomes two tiered. In the first step, one generates random deviates\n \u00bc N \n, \n\u00f0 \u00de,  \u00bc N #\n, #\n\u00f0 \u00de,  \u00bc N \n, \nwhere N , \n\u00f0 \u00de is a random normal deviate of mean  and standard deviation . At the next\nstep, one calculates\n%\n\n\nB\n@\nC\n\n\n\nB\n@\nC\nA where T\u00c01 \u00bc\nB\n@\nC\nand, finally,\nr \u00bc  %\n\u00f0 \u00de, g \u00bc  \n\u00f0 \u00de, b \u00bc  \nThis may yield apparently very different RGB histograms. Starting values for the\nparameters may be obtained from the analyses of examples.\nIn most cases, this will almost perfectly simulate samples from the actual image or\ndatabase (Figure 17 left for the pebbles image). Exceptions are cases of very\ninhomogeneous data sources (Figure 17 right for the parrots image). However, even in\nthese cases, the results may well be acceptable for many purposes.\nNote that the functions , \u00c01 model mutually extremely diverse types of physics, ranging\nfrom something like Kubelka\u00adMunk theory of radiative propagation in layered turbid media\nto photoelectronic imaging. The parameter that sets the overall level is \n, whereas the\nvariety of different levels in the scene is captured by \n. The parameters #\n, \n, #\n, \nmodel the spectral articulation. Typically #\ndominates the articulation, it is the slope of\nthe SA spectrum. It controls the red\u00adblue spread. The parameter \ntends to be of least\nimportance. It sets the curvature of the SA spectrum, controlling the green\u00adpurple spread.\nAutomatic digital cameras are designed to set \nto a standard level (e.g., the gray card\nlevel) and to set #\nand \nto zero (the automatic ``white balance''). There might even be an\nattempt to control \n(the ``contrast''), although this is less common.\nKoenderink and van Doorn 19\nThus, the most informative data is in the three parameters f\n, #\n, \ng. This triple is useful\nas a global spectral signature for the gist of the database.\nIn applications, one would estimate the parameters from a fiducial set of images, like done\nin the previous section. It is even a reasonable proposition to estimate parameters from a\nsingle, large image. A simple application might be to find a generator for typical terrain\ncolors for use in military camouflage. All that is needed is to provide representative\nimages. In Figure 18, three instances are shown. All conform closely to the assumptions\n(prairie image Z \u00bc 2:8, Arizona desert Z \u00bc 9:6, black moor Z \u00bc 11:2). Note how the\ncamouflage colors indeed neatly represent the terrain colors.\nIn cases, an ``alien'' effect is aimed at (like in SF movies), parameters can be assigned more\nfreely, or indeed almost arbitrarily. A simple example is to set f\n, #\n, g to zero and\nf\n, #\n, \ng all to the same value, chosen such that the RGB histograms become\napproximately flat. Then the RGB covariance matrix will be roughly proportional to the\nunit matrix, very much unlike the typical form for the sublunar. An array of sampled\ncolors looks ``garish'' and unlike anything you might expect to find in nature.\nAn example is shown in Figure 19 at right. The RGB covariance matrix for this sample is\nCRGB\n\u00bc\n@\nA. In the same figure (Figure 19) at left is a sample with parameters\nthat might belong to the sublunar. In this case, the RGB covariance matrix is\n@\nA. The alien sample differs from the sublunar sample in various\nways, but these are perhaps most striking:\n--almost all colors are far away from the achromatic axes;\n--there is an overdose of saturated greens and purples.\nFigure 17. The large square is filled with simulated color samples, whereas the central square inset is filled\nwith actual database samples. The inset has been outlined at right, because in this case (the pebbles image) the\nsimulated gamut cannot be discriminated from the true one. The case of the parrots image (left) is expected\nto be about ``worst case'' and indeed, the inset square can be discriminated even without the outline.\nFigure 18. Photographs of the prairie, the Arizona desert and the black moor with insets filled with\nartificially generated samples based on the statistical analysis of the images.\nKoenderink and van Doorn 21\nThus, the algorithm offers a very wide range of readily parameterized color gamuts, which\nrenders it useful for vision research.\nThe algorithm is sufficiently simple that an interactive developing environment is not hard\nto implement, allowing a designer to arrive at desirable \u00c3\u00c2\u00c4 values through an intuitive\ninterface.\nDiscussion\nWe discuss three major topics, the ecological optics of the sublunar realm, the consequences\nof the generic structure of the SA spectrum for the understanding of the structure of the\nhuman visual sense from an evolutionary perspective, and possible applications in\ncomputer graphics and image processing.\nEcological Optics of the Sublunar\nSublunar color gamuts have a simple structure that is invariant over mutually very different\ndomains. This is the case because they all derive from a few generic properties of ecological\nphysics. The main facts of relevance are the narrowness of the visual window and the extent\nof the SA spectrum autocorrelation length.\nTaking account of the mapping of essentially linear physical interaction domains to the\nobservation domain greatly simplifies the descriptions. The six parameters\nf\n, #\n, \n, \n, #\n, g typically suffice to characterize the empirical observations of diverse\ndomains. Estimating these parameters from a set of typical images yields useful generic\ndescriptions of these domains. It is likely to be more productive and useful than the\nconventional methods of acquiring a necessarily rather limited set of reflectance spectra\nand characterizing these via principal components analysis. The latter is especially\nproblematic in the observation domain because linear combinations of the principal\ncomponents often assume nonphysical, negative values.\nFigure 19. Two random gamuts, obtained with different parameter settings. At left a gamut that might well\nbelong to the sublunar realm and at right a clearly ``alien'' gamut.\nThe constant \u00c9 \u00bc 0:114 . . . appears to be a universal constant for the sublunar domain. It\nspecifies how fast the autocorrelation of the articulation spectrum falls off with the width of\nthe visual band. Most important deviations from this global pattern--seen from a\nphenomenological perspective--are the ``sky colors'' and the colors due to atmospheric\nperspective. Changes in illumination--be it changes in mere radiative power or (slight)\nchanges in spectral distribution (say from sunlight to skylight)--will hardly imprint\nthemselves on the covariances used in this study.\nThey will merely make the environment appear a little lighter or darker and will most\nlikely contribute a trend to normality in all channels. Finally, outliers on smallish spatial\nscales are generally due to flowers, butterflies, some minerals, and on a slightly broader scale\nhuman artifacts like paints and so forth. Such outliers are unlikely to be of much\nconsequence, due to their relative scarcity.\nDepending on one's aims, it may be of interest to refine the statistics. Obvious targets are\nthe deviations from normality of the \u00c3\u00c2\u00c4 distributions. Since the precise form of the\nsigmoid function is arbitrary, one may force the \u00c3 distribution to normal form. Then the\ndeviations from normality of the \u00c2 and \u00c4 channels become meaningful parameters. They are\nlikely to be domain specific.\nOur results are in accordance with Attewell and Baddeley (2007) who measured full\nspectral reflectance functions in the field. However, these authors remain in the reflectance\ndomain and do not consider spectral correlations.\nFull (high-resolution) spectral imaging (Ruderman, Cronin, & Chiao, 1998) also yields\nresults close to these found here. Their estimation of the precise opponent directions is similar\nto ours. Apparently true hyperspectral imaging (a major chore) does not yield much beyond\nmere RGB crowd sourcing. This is only to be expected.\nArticulations of the SA Spectrum and the Human Visual Sense\nAs we have shown, the opponent directions as phenomenologically identified by Hering\n(1920), turn out to derive from ecological physics. Their dominant appearance in the\necological optics is due to the nature of the spectral articulations. The structure of the SA\nspectrum in a three-bin representation is characterized by the SA spectral slope and the SA\nspectral curvature, two properties that are expected to be mutually uncorrelated, whereas the\nfirst order (slope) is expected to dominate the second order (curvature). This gives rise to the\ndominant eigendirections found in essentially any image of the sublunar realm.\nThus, Hering's opponent colors, identified from a phenomenological analysis, may well\nhave resulted from an evolutional drive toward the informationally desirable decorrelation of\nsensor channels.\nIn view of the empirical value of \u00c9, it appears a good design objective to limit the\nbiological spectral resolution to a mere two or three degrees of freedom, as indeed resulted\nfrom evolutionary pressure. Because the correlation length of the SA spectrum is of the order\nof a spectral bin width, there is hardly a pressure for tetrachromacy from an ecological\nperspective.\nThus, both trichromacy and opponency appear as adaptations to the ecological optics of\nthe sublunar realm.\nThat opponent channels serve to effectively decorrelate the spectrally related optics nerve\nactivity was already suggested by Buchsbaum and Gottschalk (1983). However, these authors\neffectively find the principal components of the color matching functions, not the spectral\ncovariance. Thus, they implicitly treat the spectrum as white noise and the correlation\nstructure as due to the mutual overlap of the color matching functions. This is\nKoenderink and van Doorn 23\ncategorically different from our perspective. However, from a biological perspective, the color\nmatching functions are evolution's answer to the spectral correlation, so the similarity of\nresults is perhaps not a miracle, though certainly far from trivial.\nTechnology arrives at similar insights by a process of successive improvements driven\nby practical constraints. That the RGB channels tend to be highly correlated was already\nused in the 1953 (second) NTSC standard for analog TV. The luminance\u00ad\nchrominance encoding was already invented in 1938 by Georges Valensi.18 The\n(which may serve to drive monochrome receivers) and chrominance signals\nis a red\u00adcyan and the Q signal is a magenta\u00adgreen opponent signal. The Y signal is\nallotted a bandwidth of 4Mhz, the I-signal 1.3 Mhz, and the Q signal 0.4 Mhz, this\nevidently reflects the typical covariances found in RGB images. The YIQ encoding is often\nconstrued as fitting the human visual system, in reality it fits the covariance of the spectra of\nthe sublunar realm.\nApplications in Computer Graphics and Image Processing\nRandom gamut generators are likely to find applications in computer graphics, where it is\noften desirable (for instance in synthesizing various landscapes) to generate large numbers of\ninstances of colors belonging to a restricted setting in an intuitively parameterizable way. Of\ncourse, such reflectance factors can be combined with various spectral illuminants to\ntransform the gamut, say from a noon to a later afternoon setting.\nSuch color generators may also find application in interior design, textiles design, and so\nforth. They yield color gamuts that can be made to perfectly fit any well-defined environment\nin a simple, principled manner.\nAlthough this exercise in capturing the ``color gamuts of the sublunar'' is possibly useful,\nthere remain--of course--numerous loose ends. Some are due to the extreme generalizations\nthat had to be made. As a consequence, numerous important effects of ecological optics were\nfully ignored. Perhaps most blatantly, no account was taken of the effects of geometry,\nobviously of major importance to the irradiation of the scattering surfaces and thus to the\nradiance scattered to the camera or eye. Such issues become relevant in applications of\nmachine vision and image processing. Examples include image segmentation (Comaniciu &\nMeer, 1997) and recognition on the basis of color gamuts (Gevers & Smeulders, 1999). Here,\nmore intricate statistical analysis, as mentioned above, may well turn out to be useful.\nConclusions\nSo what are the gamuts of the sublunar like? In view of the correlations shown in Figure 16\nand perhaps surprisingly, a rather specific answer is possible. First of all, they are quite gray,\ntouches of hues being special--thus biologically important. The variations are dominated by\nmonochrome contrast. The major chromatic variations are in the range from orange to\ngreenish\u00adblue, or--as painters have it--``warm'' to ``cool.'' Minor variations are in the\nrange green to dark purple, what painters sometimes denote as ``moist'' to ``dry'' (Benson,\nThe big picture is evidently dominantly GRAY contrast with some red\u00adblue and even fewer\ngreen\u00adpurple variations. This is largely due to basic physics (especially clear in Figure 21 of\nAppendix B) and constraints of human physiology which--by way of evolution--most likely\nhave been shaped by the ecological structure itself.\nDeclaration of Conflicting Interests\nThe author(s) declared no potential conflicts of interest with respect to the research, authorship, and/or\npublication of this article.\nFunding\nThe author(s) disclosed receipt of the following financial support for the research, authorship, and/or\npublication of this article: The work was supported by the DFG Collaborative Research Center SFB\nTRR 135 headed by Karl Gegenfurtner (Justus-Liebig Universita\n\u00a8 t Giessen, Germany) and by the\nprogram by the Flemish Government (METH/14/02), awarded to Johan Wagemans. Jan\nKoenderink was supported by the Alexander von Humboldt Foundation.\nSupplemental Material\nThe online appendix movies are available at http://journals.sagepub.com/doi/suppl/10.1177/\nNotes\n1. The R, G, and B values are taken to be confined to the range \u00bd0, 1.\n2. Note that the colorimetric literature would use ``magenta'' instead of ``purple'' and ``cyan'' instead\nof ``turquoise.'' We prefer the more common terms used in the visual arts and so forth.\n3. The notion of ``Umwelt'' derived from biology, or, more precisely ethology. One means that part of\nthe sublunar realm that is causally involved in stimulating an animal's senses and that part of an\nanimal's effectors that may change the environment. Different animals tend to have different\nUmwelts, even though they coexist in a single physical environment.\n4. Two spectra that cannot be visually discriminated differ by an element of the null-space. There are\ninfinitely many of such ``metameric blacks.''\n5. Linear projections conserve convexity and central symmetry.\n6. The normalized covariance matrix is\nB\n@\nC\nA .\n8. Of course, one could easily make it a ``true octave'' by taking the tails of the color matching functions\ninto account. We would say that ``somewhat less than an octave'' is the most useful statement.\n9. This is a generic example, of course. In practice, the diagonal elements often differ somewhat and so\nforth. The main conclusions from the example remain unchanged when the matrix is somewhat\nperturbed. In contradistinction, the ``default'' case mentioned above gives rise to a roughly diagonal\nmatrix.\n10. The reflectance factor defined as the ratio between a radiometric reading for sample surface and the\nreading for a white card held in the same spatial attitude and location.\n11. Purely phenomenologically one might expect red\u00adcyan, green\u00admagenta and blue\u00adyellow as\nopponent colors, for these are the only complementary cardinal color pairs and there is no a\npriori reason to choose between them. Picking any two from these three requires a reason, which\nappears to be lacking.\n12. Kubelka\u00adMunk theory is not essentially involved with spectral descriptions. Kubelka-Munk theory\nis important for other reasons that are explained below.\n13. Imaging is not essentially involved with spectral descriptions. Imaging is important for other\nreasons that are explained below.\nKoenderink and van Doorn 25\n14. In Google Image ``Search Tools'' one has ``Any size,'' ``Large'' and ``Medium.'' Medium size is\n15. In this section, all channel values are given as rounded values between 0 and 100. This is preferable\nfrom typographic perspectives and reads easily. From a coding perspective, the range 00\u00ad99 (all\ntwo-digit numbers, in contradistinction to 0\u00ad100, which has one, two- and three-digit numbers) is\nperhaps most convenient.\n16. Often done automatically by the in-camera firmware, otherwise usually by some image correction\nprocess, often automatic, sometimes manually (the ``levels'' or ``curves'' methods of programs like\nAdobe's Photoshop). One expects r : g : b % 1 : 1 : 1 on the average.\n17. In most images, one finds an accumulation of debris at the limits. This is due to radiance levels\nexceeding the dynamic range of the sensor. In the case of the (typical) byte (0\u00ad255) representation it\nis always a wise decision to limit the range to 1\u00ad254, perhaps even better to 5\u00ad250. This has the\nadditional advantage that the inverse sigmoid transformation will never meet an argument it cannot\nhandle.\n\u00b4 de\n\u00b4 de te\n\u00b4 le\nReferences\nAttewell, D., & Baddeley, R. J. (2007). The distribution of reflectances within the visual environment.\nBarrett, H. H., & Myers, K. J. (2003). Foundations of image science. New York, NY: Wiley.\nBenson, J. L. (2000). Greek color theory and the four elements. Amherst, MA: University of\nMassachusetts Amherst Libraries.\nBuchsbaum, G., & Gottschalk, A. (1983). Trichromacy, opponent color coding and optimum colour\ninformation transmission in the retina. Proceedings of the Royal Society of London, Series B,\nChapeau\u00adBlondeau, F., Chauveau, J., Rousseau, D., & Richard, P. (2009). Fractal structure in the\ncolor distribution of natural images. Chaos, Solitons and Fractals, 42, 472\u00ad482.\nComaniciu, D., & Meer, P. (1997). Robust analysis of feature spaces: color image segmentation.\nProceedings of IEEE Computer Society Conference on Computer Vision and Pattern Recognition,\nFairman, H. S., & Brill, M. H. (2004). The principal components of reflectance. Color Research &\nFeynman, R., Leighton, R., & Sands, M. (1963\u00ad1965). The Feynman lectures on physics (Library of\nCongress Catalog Card No. 63\u00ad20717), Reading, Mass: Addison-Wesley Pub. Co.\nGevers, T., & Smeulders, A. W. M. (1999). Color\u00adbased object recognition. Pattern Recognition, 32,\n\u00a8ge der Lehre vom Lichtsinn [Fundaments of visual perception]. Berlin,\nGermany: Julius Springer.\nJaynes, E. T. (1968). Prior probabilities. IEEE Transactions on Systems Science and Cybernetics, 4,\nJeffreys, H. (1939). Theory of probability. Oxford, England: Oxford University Press.\nJeffreys, H. (1946). An invariant form for the prior probability in estimation problems. Proceedings of\nKoenderink, J. J. (2010a). Color for the sciences. Cambridge, MA: MIT Press.\nKoenderink, J. J. (2010b). The prior statistics of object colors. Journal of the Optical Society of America\nKoenderink, J. J., van Doorn, A. J., Albertazzi, L., & Wagemans, J. (2015). Hue contrast and the sense\nKohonen, O., Parkkinen, J., & Jaa\n\u00a8 skelai\u00a8nen, T. (2006). Databases for spectral color science. Color\nKoschmieder, H. (1924). Theorie der horizontalen Sichtweite [Theory of horizontal visibility]. Beitra\u00a8ge\nKubelka, P., & Munk, P. K. F. (1931). An article on optics of paint layers. Zeitschrift fu\n\u00a8r technische\nLonguet\u00adHiggins, M. S. (1957). The statistical analysis of a random moving surface. Philosophical\nTransactions of the Royal Society of London A: Mathematical, Physical and Engineering Sciences,\nMiddleton, W. (1952). Vision through the atmosphere. Toronto, Canada: University of Toronto Press.\nOliva, A., & Torralba, A. (2006). Building the gist of a scene: the role of global image features in\nOppenheim, A., Schafer, R., & Stockham, T. (1968). Nonlinear filtering of multiplied and convolved\nPoynton, C. A. (2003). Digital video and HDTV: Algorithms and interfaces. San Francisco, CA: Morgan\nKaufmann.\nRuderman, D. L., Cronin, T. W., & Chiao, C. C. (1998). Statistics of cone responses to natural images:\nSchro\n\u00a8 dinger, E. (1920). Theorie der Pigmente von gro\n\u00a8 sster Leuchtkraft [Theory of most luminous\nStrutt, J. (1899). On the transmission of light through an atmosphere containing small particles in\nsuspension, and on the origin of the blue of the sky. Philosophical Magazine, Series 5, 47, 375\u00ad394.\nTorralba, A., & Oliva, A. (2002). Depth estimation from image structure. IEEE Transactions on Pattern\nTzeng, D. -Y., & Berns, R. S. (2005). A review of principal component analysis and its applications to\nAuthor Biographies\nJan Koenderink (born in 1943) is Professor Emeritus (in physics)\nfrom the University of Utrecht. He has worked in physics,\nmathematics, psychology, biology, philosophy and computer\nscience. His main interests focus on the nature of awareness,\nespecially for the case of vision. Much of his work is related to his\ninterests in artistic expression.\nAndrea van Doorn (born in 1948) is an Emeritus Associate Professor\nat the Technische Universiteit Delft in Industrial Design. Her\nresearch interests are cognitive science, ecological physics, human\ninterfaces, non- verbal communication, and visual phenomenology.\nShe has a keen interest in the visual arts.\nKoenderink and van Doorn 27\nAppendix A\nSimulation of Sublunar Spectra\nUsing the basic physical insights that the spectral envelope is statistically translation invariant\nalong the spectral axis and that its autocorrelation function is peaked, falling symmetrically\nand monotonically off toward both sides, one readily simulates the basic structure of the\nsublunar colors.\nSince we have no data on the shape of the autocorrelation function, we simply use a\nLaplace distribution (note that\nR\nL\u00f0x, \u00dedx \u00bc 1)\nL\u00f0x, \u00de \u00bc\ne\u00c0jxj\n\nwith Fourier transform\nS\u00f0 f \u00de \u00bc\nffiffiffiffiffiffi\np\nOther peaked functions, like the Gaussian, yield very similar results. It seems possible that\nmore homogeneous data might render it reasonable to attempt to differentiate further, we do\nnot attempt that here.\nRandom spectra are computed by convolving this kernel with white noise, generated as a\nlist of normal deviates. This yields signals with a SA power spectrum that falls off with the\nsquare of the SA frequency. (Typically the convolution is computed via FFT, which assumes\nperiodic boundary conditions. Thus, it is important to compute spectra over a much longer\ninterval than will be used in an observation. Failing to do so introduces a spurious correlation\nbetween the outermost bins.)\nThe resulting spectra are generated in the physical domain. Before transforming to the\nobservation domain, one may arbitrarily scale and shift the functions so as to obtain a fairly\nFigure 20. At left, 10 random spectra from the model. The parameter  taken equal to the bin width. The\nSA power spectrum varies with the inverse square of the frequency. At right, a histogram based on a thousand\nof such spectra, pooled across wavelengths.\ntypical histogram of the values. The exact choice is of hardly any relevance to the eventual\nresult. However, it increases the illusion of ``reality'' of the simulation.\nThe resulting spectral samples could hardly be distinguished from a set of a few thousand\nobservations from the sublunar realm (Figure 20). This is perhaps due to an overdose of\ndetail. Translation invariance and the overall nature of the autocorrelation function, or,\nequivalently, the mean spectral articulation power spectrum, are the determining factors.\nThe covariance matrices of this type of simulation can be readily appreciated from about a\nthousand samples or so. A million samples are easily computed in reasonable time, but are\nreally overkill. In this case\nB\n@\nC\nthus the ratio of the opponent variances is 4. The result depends mainly on the choice of the\ncorrelation length  (here taken equal to the bin width), relative to the bin width.\nIt is of some interest to consider the distribution of RGB values in the RGB cube (Figure 21\nleft). As expected, there is a much wider range in the orange\u00adgreenish blue than in the green\u00ad\npurple. The distribution over the white\u00adblack axis is mainly due to the setting of offset and\nwidth in the physical domain, they hardly affect the resulting opponent covariance matrix.\nSetting the shift to zero and the scaling very high, the generated spectra become\napproximately random telegraph waves. This is the limit we have considered in an earlier,\nmainly theoretical, investigation (Koenderink, 2010b). The RGB colors largely concentrate\non the edge color series black\u00adred\u00adyellow\u00adwhite and white\u00adturqoise\u00adblue\u00adblack. The green\u00ad\npurple dimension is hardly populated (see Figure 21 right). The covariance matrix becomes\nFigure 21. Left: A thousand random RGB samples from the model. The parameter  taken equal to the bin\nwidth. Right: A thousand random RGB samples from the model in the case of zero shift and large scaling. The\nspectra are approximately degenerated to random telegraph waves. Note that the random RGB colors\naccumulate on six of the edges of the cube, the other edges remaining unpopulated. These colors are\nGoethe's edge colors (G. Kantenfarben).\nKoenderink and van Doorn 29\n@\nthus the ratio of the opponent variances is 3. The material discussed here is available on the\nwebsite of the publisher as Mathematica Notebooks, that can be read with the free\nMathematica Reader, or run in the Mathematica application. (For Mathematica see\nhttps://www.wolfram.com/mathematica/).\nAppendix B\nThe Data Sources\nThe data sources range from single images to databases containing over 5,000 images:\nOverall, about 10, 000 images were used in a variety of sizes. The square sizes (the ``square\nsize'' is defined as the rounded square root of the total number of pixels in the image; it is a\nconvenient measure, since aspect ratios vary all over the place) range from 256 to almost\nThe images are rather uniform data sources, they were selected for that. The databases are\nalso uniform in a sense, although there is quite a bit of variation. Overall, it makes sense to\ntreat the images and the databases (which may contain numerous images) as individuals in\nthe analysis.\nIndex Name #Items Size Data volume"
}