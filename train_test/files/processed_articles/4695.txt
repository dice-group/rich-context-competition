{
    "abstract": "Abstract. Surface properties provide useful information for identifying objects and interacting with\nthem. Effective utilization of this information, however, requires that the perception of object surface\nproperties be relatively constant across changes in illumination and changes in object shape. Such\nconstancy has been studied separately for changes in these factors. Here we ask whether the\nseparate study of the illumination and shape effects is sufficient, by testing whether joint effects\nof illumination and shape changes can be predicted from the individual effects in a straightforward\nmanner. We found large interactions between illumination and object shape in their effects on\nperceived glossiness. In addition, analysis of luminance histogram statistics could not account for\nthe interactions.\n",
    "reduced_content": "a Pion publication\nJoint effects of illumination geometry and object shape in\nthe perception of surface reflectance\nMaria Olkkonen\u00b6\nDepartment of Psychology, University of Pennsylvania, 3401 Walnut St, Philadelphia, PA 19104, USA;\ne-mail: maria.olkkonen@rutgers.edu;\nDavid H Brainard\nDepartment of Psychology, University of Pennsylvania, 3401 Walnut St, Philadelphia, PA 19104, USA;\ne-mail: brainard@psych.upenn.edu;\n Keywords: vision, material perception, surface reflectance, illumination, shape, conjoint measurement, percep-\ntual constancy, luminance histogram statistics.\n1 Introduction\nVisual perception of object surface reflectance properties can aid object identification and\nguide tactile interaction with objects (Adelson 2001). For example, how glossy an object\nappears provides information about how tightly it should be gripped to avoid slippage.\nThe percepts are useful, however, only to the extent that they are stable across variation in\nillumination and object shape. Because the light reflected from an object varies with these\nobject-extrinsic factors, stable perception of surface properties requires visual processing of\nthe raw retinal image (see Figure 1). A fundamental question is how and to what extent such\nstabilization is accomplished by the visual system.\nThe geometric aspects of a surface's reflectance can be approximated by its bidirectional\nreflectance distribution function (BRDF), which describes the amount of light reflected as a\nfunction of the directions of the incident and reflected light (Nicodemus et al 1977). Moreover,\nthe BRDFs of many common surfaces can be described by simple parametric models. Here\nwe will employ the isotropic Ward BRDF model (Ward 1992). At each wavelength, this model\nspecifies reflectance as the sum of a non-directional diffuse component (d) and a directional\nspecular component. The strength of the specular component is described by the parameter\ns and its spatial spread by a roughness parameter . We assume s and  are constant as a\nfunction of wavelength, while d has a spectral dependence. Roughly speaking, the perceived\ncolor and lightness of an object correlate with the diffuse reflectance component, while the\nperceived glossiness correlates with the specular component.\nThe constancy of surface color and lightness perception for flat matte objects and simple\nillumination geometries has been extensively studied and is now fairly well understood (see\nreviews on lightness by Adelson (2000) and Kingdom (2010) and on color by Shevell and\nKingdom (2008) and Brainard and Maloney (2011). Perception of color and lightness for\n\u00b6 Corresponding author.\nJoint effects of illumination and shape 1015\nFigure 1. This scene contains objects with different surface geometries, shapes, and surface re-\nflectance properties viewed under spatially varying illumination. The identification of surface\nmaterial--porcelain, fabric, wood, glass--is important for object identification and action planning\nbut is complicated by the fact that the signal coming to the eye depends not only on surface reflectance\nbut also on the illumination and object shape. The insets on the right show close-ups of different parts\nin the image, with the numbers next to the insets corresponding to the numbers in the picture. Note,\nfor example, the variation in the image corresponding to different locations on the vase (locations 1\nand 2) and the similarity between a location on the vase (location 2) and on the wooden window sill\n(location 3). The photograph is courtesy of Toni Saarela.\nnon-matte and three-dimensional objects has historically received less attention but is being\nactively studied, perhaps because of the availability of computer graphic techniques for\nstimulus generation and display (see Maloney and Brainard 2010). Similarly, the study of the\nperceptual correlates of geometric aspects of object reflectance (aka material properties) is\nalso of much current interest (again, see Maloney and Brainard 2010).\nIt is clear that human observers can judge the glossiness of three-dimensional objects\nand that this percept varies with the specular component of object reflectance (eg, Beck\net al 2004; Ji et al 2006). Which aspects of the image drive this percept are less clear. Some\nauthors have emphasized the causal role of low-level image cues derived from the luminance\nhistogram of the object's image (Nishida and Shinya 1998; Motoyoshi et al 2007; Sharan et\nal 2008), while others have noted the importance of the relationship between luminance\nvariation and perceived object shape (Beck and Prazdny 1981; Blake and B\u00fclthoff 1990;\nMarlow et al 2011). There have also been some initial studies of the stability of perceived\nglossiness under variations in scene illumination (Fleming et al 2003; te Pas and Pont 2005;\nand Pont 2010), and variations in object shape (Vangorp et al 2007). Taken as a whole these\nstudies indicate that the visual system does stabilize the percept to some degree, but by no\nmeans perfectly. It is not well-understood how the stabilization is accomplished, nor when it\nworks well and when it fails.\nHuman observers can also judge the lightness of three-dimensional objects even when\nthey are viewed in isolation (Beck 1964; Sharan et al 2008). This is possible because of the\nshadows and interreflections caused by the three-dimensional surface structure, which\nprovide cues to surface reflectance. In addition, Motoyoshi et al (2007) and Sharan et al (2008)\nfound that perceived lightness was relatively stable when the specular component of surface\nreflectance was varied (see also Xiao and Brainard 2008). There were some deviations from\nconstancy, however, and these authors proposed a theory that based perceived lightness on\nluminance histogram statistics to account for their results. Data from other authors, however,\nsuggest that such simple theories do not generalize well to a broader class of stimulus\nof diffuse reflectance also depends on illumination geometry and object shape (Khang et\nal 2003), and it is better under some illuminants than others. As with perceived glossiness,\nthere have not been studies that covary both illumination geometry and object shape.\nThe fact that perceived lightness and glossiness vary with both illumination geometry\nand object shape raises a fundamental question: Do these effects interact? This question is\nimportant, since the answer will provide guidance about the generality of conclusions that\nmay be drawn from studies that vary object shape under a fixed illumination geometry (eg,\nthat vary illumination geometry for a fixed object shape (eg, Fleming et al 2003; Pont and te\nfactors interact, understanding the perception of glossiness and lightness for natural images\nwill either require a large database of factorial measurements or a theory of the interaction\nthat would enable prediction of the joint effects from a smaller set of measurements. Since\nmaking a full set of factorial measurements is not tractable, we believe that exploring the\nquestion of interactions is a priority.\nHere we report experiments that study the perception of both glossiness and lightness\nfor three-dimensional objects and concentrate on the stability of these percepts across joint\nvariations in illumination geometry and object shape. To minimize artifacts that might result\nfrom the limited dynamic range of conventional computer displays (Phillips et al 2009;\nDoerschner, Boyaci et al 2010), we used a custom high-dynamic range display so that our\nstimuli incorporated the large variations in luminance that can be generated by specular\nreflection under directional illumination. We tested whether the data for joint manipulations\nof shape and illumination geometry could be predicted by models that treat the effects of\neach variable as separable and found profound interactions for judgments of glossiness. We\nasked whether the interactions could be accounted for by image-based models that have\nbeen suggested by others but found that these also failed. Our data thus provide a challenge\nfor future modeling efforts.\nThe purpose of the experiments was to measure how changing both illumination\ngeometry and object shape affect perceived glossiness and lightness. On each trial of the\nexperiment, observers judged which of two objects appeared glossier or lighter (depending\non the trial type), and a staircase procedure was used to adjust the reflectance properties of\none of the objects to seek the point of subjective equality. The objects could either be the\nsame shape illuminated by different light fields, different shapes illuminated by the same\nlight field, or different shapes illuminated by different light fields.\nJoint effects of illumination and shape 1017\nFour naive observers participated in the experiment. All four ran conditions with the\nGrove/Kitchen light field pair (see below for explanation of the conditions). Three of the\nfour observers also ran conditions with the Grove/Galileo light field pair. All participants\nhad normal visual acuity (20/20) as verified with a Snellen chart and normal color vision\nas verified with the Ishihara color plates. The experimental protocols were approved by the\nhuman subjects institutional review board (IRB) at the University of Pennsylvania and were\nin accordance with the World Medical Association Helsinki Declaration as revised in October\nWe generated two shapes using the Maya 3D modeling software (Autodesk, Inc.) by modu-\nlating a sphere with three sinusoids of different frequencies, phases, and amplitudes (see\nFigure 2). For mnemonic convenience, we refer to the shapes as Blob and Pepper. Wireframe\nmodels of the shapes were exported from Maya and rendered with specified reflectance\nparameters under three real-world light fields captured by Debevec (1998). The rendering was\nperformed using Radiance (Ward 1994) via the RenderToolbox (www.rendertoolbox.org) Mat-\nlab routines. The RenderToolbox provides wrappers that allow wavelength-by-wavelength\nspecification of surface reflectance and illuminant spectral power.\nGrove Kitchen Galileo Grove Kitchen Galileo\n\nd\nd\n\ns\n\ns\nGrove Kitchen Galileo Grove Kitchen Galileo\n\ns\n\ns\n\ns\n\ns\n\ns\n\ns\n\nd\nd\nFigure 2. The reference stimulus set. The two levels of reference diffuse reflectance (d) are shown in\nthe two major columns and the two levels of reference specular reflectance (s) are shown in rows.\nThe three column images show the same stimulus rendered under three different light fields (Grove,\nKitchen, and Galileo). The two shapes are shown in the two major rows. The checkered backgrounds\nhave been cropped relative to their size in the experiment. The actual stimuli were high-dynamic\nrange images. To render the images for publication at a low dynamic range, they were transformed\nfrom the LMS cone representation to the sRGB standard primaries, gamma corrected by taking the\nsquare root of each value, and scaled by eye with high luminance values clipped, so as to preserve as\nwell as possible the relative appearances they had when displayed at high dynamic range. The same\nprocedures were used to produce the other stimulus images shown in the paper.\nThe diffuse reflectance of the object surface was that of surface 14 in the GretagMacbeth\ncolor chart (Munsell notation 0.25G 5.4/8.65). To render the scenes spectrally within the\nRenderToolbox environment, the RGB light fields provided by Debevec were converted to a\nspectral representation. The procedure used is described in Olkkonen and Brainard (2010).\nThe light fields were scaled so that the mean luminance reflected from a matte Blob with the\ndiffuse reflectance of Munsell 0.25G 5.4/8.65 was the same for each light field. We chose a\ntarget mean luminance for the matte images of 4 cd/m2, which was a compromise between\nobtaining a reasonably high mean luminance and minimizing the amount of tone mapping\nrequired to render the stimuli. The light fields varied in their mean chromaticities, a feature\nthat was preserved in the experimental stimuli. We refer to the light fields as Kitchen, Grove,\nand Galileo, based on the locations where they were captured (a kitchen, a eucalyptus grove,\nand Galileo's tomb).\nThe objects varied in their geometric reflectance properties. As described in the intro-\nduction, we used the isotropic Ward (1992) BRDF model and specified geometric reflectance\nusing its specular (s), diffuse (d), and roughness () parameters. A value of d = 1\ncorresponded to a diffuse spectral reflectance function equal to that of Munsell 0.25G\n5.4/8.65, and other values scaled this reflectance function equally at all wavelengths. On any\ngiven trial, two stimuli were shown, a reference stimulus, which could take on any of four\nreflectances, and a comparison stimulus, whose reflectance was determined by an adaptive\nstaircase algorithm (see Procedure). We chose two levels of reference specular reflectance\n(s = [0.04 0.16]) and two levels of diffuse reflectance (d = [.4 .9]). The roughness parameter\nwas kept constant at Ward  = 0.01.\nThe rendering procedure resulted in a hyperspectral image with 31 planes, with each\nplane corresponding to one wavelength band. Sample wavelengths were between 400 and\n700 nm at 10 nm steps. The hyperspectral image was converted to an LMS cone image using\nthe Stockman-Sharpe two-degree cone fundamentals (Stockman and Sharpe 2000). Where\nrequired, tone mapping was accomplished by setting pixels with luminances above the\nmaximum displayable value (460 cd/m2 ) to that value while preserving their chromaticities.\nDuring the experiment, we needed to vary the reflectance properties of the comparison\nstimuli. To do so rapidly, we adjusted and combined two pre-rendered basis images (Griffin\nmatte stimulus and one a glossy stimulus. By taking the difference between the glossy and\nmatte basis images, we could extract a difference image that represented the effect of adding\na specular component to the stimulus' reflectance. To generate stimuli with different levels\nof specularity, we combined the matte basis image with the difference image and varied the\nweight on the difference image. To simulate different levels of diffuse reflectance, we scaled\nthe matte basis image prior to combination with the scaled difference image.\nThe stimuli were embedded in a checkerboard background, where the chromaticities and\nluminances of single checks were drawn from a three-dimensional Gaussian distribution\nVos xyY). The values approximate the mean and standard deviation xyY values averaged\nacross the bit maps of the three light fields used in the experiments.\nTable 1 lists the CIE chromaticities and luminances of the reference stimuli, obtained by\ntaking the spatial mean over each object.\nThe stimuli were displayed on a custom high-dynamic-range (HDR) display. Briefly, the\ndisplay consisted of an LCD flat-panel display with the backlight replaced by a three-chip\nDLP video-projector that illuminated the LCD screen with a projected image. By controlling\nthe input setting to both LCD screen and DLP projector, this arrangement allows large (>\nJoint effects of illumination and shape 1019\nTable 1. The Judd-Vos corrected CIE chromaticities and luminances of the reference stimuli, averaged\nover all stimulus pixels.\nReflectance Shape Grove Kitchen Galileo\nBlob\nPepper\nBlob\nPepper\nBlob\nPepper\nBlob\nPepper\n10,000:1) modulation of the image intensity at each pixel. Both display devices were driven at\n(NVIDIA GeForce GT 120). The host computer was an Apple Macintosh with a quad-core Intel\nXeon processor. The display is described in detail in an earlier report (Olkkonen and Brainard\n2010). Since publication of that work, some improvements in the calibration and display\ncontrol software were implemented. These are described in a technical report (Radonji\u00b4\nc et al\n2011). The maximum luminance of the display was 460 cd/m2. The minimum luminance\nwas below the measurement range of our radiometer, but at least a factor of 10,000 below the\nmaximum luminance.\nThe experiment was programmed in Matlab (MathWorks, Inc) with display control\nfunctions based on the MGL toolbox (http://justingardner.net/mgl) and the Psychtoolbox\n(Brainard 1997; Pelli 1997). We used the Jacket software (http://www.accelereyes.com/) to\noffload some computations to a second GeForce GT 120 video card, which enabled us to\nperform rapidly the calculations needed to render the stimuli on each trial.\nOn each trial of the experiment, two stimuli were presented side by side on the display.\nThe checkerboard backgrounds subtended 9.3 degrees of visual angle on each side, with\nthe shapes subtending approximately 6 x 6 degrees. The distance between the centers of\nthe reference and comparison shapes was 9.3 degrees. The reflectance of the reference\nstimulus remained the same throughout one block. The left-right locations of the reference\nand comparison were randomized on each trial. The observer's task was to respond which\nstimulus appeared glossier/lighter depending on the trial. In 12 consecutive trials, the\nobserver gave glossiness estimates; in the following 12 trials, lightness estimates, and so on.\nThe observer was alerted when the judgment changed via synthesized speech emitted from\nthe computer. In addition, the current judgment was indicated by white text at the top of\nthe display. The exact instructions given to the observers are provided in the supplementary\nmaterials available at http://color.psych.upenn.edu/supplements/materialshape/.\nFor any given reference stimulus, there were four interleaved staircases: two for lightness\njudgments and two for the glossiness judgments. For each staircase, the starting reflectance\nparameters of the comparison were picked either below or above the reference values (two\nin each direction), and were consequently changed by a 1-up, 1-down procedure. In a given\nblock, the reflectance of the reference stimulus was kept constant, and there were two\nreference shapes and two reference light fields. As each staircase had 15 trials, there were 240\ntrials in total in one block. Each block was repeated twice to get two estimates for each data\npoint.\nThere were three blocked change conditions whose order was counterbalanced across\nobservers. In one condition, the two stimuli in a given trial had the same shape, but differed in\nillumination geometry (change light field). This condition measured the effect of illumination\ngeometry on perceived reflectance. In another condition, the two stimuli within a trial had\ndifferent shapes, but the same illumination geometry (change shape). Here, the effect of\nobject shape on perceived reflectance was measured. In the third condition, the stimuli had\nboth different shapes and different illumination geometries (change both). This condition\nmeasured the joint effect of changing illumination and object shape on perceived reflectance.\nThe experiment was run for two light field comparisons: Grove/Kitchen and\nGrove/Galileo. The experiment was completed first for one comparison, after which the\nother comparison was run. The order of the two comparisons was counterbalanced across\nobservers. Note that the shape change trials were the same for Grove in both comparisons\nand were run only once for one of the observers to minimize the length of the whole\nexperiment. For the other observers the conditions were run in full.\nWe quantified perceived glossiness and lightness as follows. For a given reference stimulus,\nchange condition, and judgment type, we averaged the reversals in each staircase after\ndiscarding the first two reversals. We then averaged over staircases to obtain the point of\nsubjective equality (PSE). In 4% of the cases, the perceptual effects were so large that there\nwere no reversals before the comparison reflectance parameters led to stimuli that reached\nthe luminance limit of the display, in which case we took this most extreme possible stimulus\nvalue as an approximation of the PSE. The display limits are indicated in the data figures, so\nthat such points may be easily identified.\nWe further summarized the data for each change condition and judgment type with linear\nregression lines fit to the data for all reference stimuli for that condition/judgment (Olkkonen\nand Brainard 2010). We assumed the offset of all lines to be zero and used just the slope\nparameter for the fits. The slopes were taken as a measure of the perceptual effect in each\ncondition. For each judgment and change condition, we obtained four slopes. For example,\nfor the glossiness judgments in the light field change condition there were two shapes and\ntwo levels of reference diffuse reflectance leading to four regression lines.\n3.1 Effects of illumination geometry\nWe found large effects of illumination geometry on perceived glossiness, confirming our\nprevious findings for spheres. This is shown for a representative observer in Figure 3a.\nEach data point shows the specularity values for a pair of stimuli that matched across the\nGrove/Kitchen light field change; data for the Blob (circles) and Pepper (squares) are shown\nseparately. The deviations of the data from the unity diagonal indicate the perceptual effect\nof the light change.\nFigure 4a summarizes the effects with the regression slopes for all of the observers. Here,\nthe deviation of slopes from unity indicates the perceptual effect. The data are generally\nsimilar across the two levels of diffuse reflectance, indicating that to first order it is sufficient\nto characterize the effect of illumination geometry on perceived glossiness by studying one\nlevel of reference stimulus diffuse reflectance (see, also, Olkkonen and Brainard 2010). Note\nthat the effect of light field is quite different for the two shapes, and for some observers (GLA,\nOCL) the effect is in the opposite direction relative to the unity line.\nData for the Grove/Galileo light field change are plotted in the same format as Figure 4a in\nthe supplementary materials (Figure S8a). The effects for that light field change were variable\nacross observers, but in general the light field again affected perceived glossiness. For one\nobserver, there was a clear effect of shape on the effect of the light field.\nJoint effects of illumination and shape 1021\nDiffuse reflectance Grove\nDiffuse reflectance Kitchen\nSpecular reflectance Grove\nSpecular reflectance Kitchen\nOCL\nOCL\n(a) (b)\nBlob, low \ns\nPepper, low \ns\nPepper, high \ns\nBlob, high \ns\nBlob, low \nd\nPepper, low \nd\nPepper, high \nd\nBlob, high \nd\nGlossiness Lightness\nFigure 3. Effect of light field on perceived reflectance, Grove/Kitchen. (a) Points of subjective equality,\nglossiness judgments, observer OCL. Each data point represents one PSE and shows the specularity\nvalue for the stimulus under the Grove light field on the x-axis and under the Kitchen light field on\nthe y-axis. Circular symbols show data for the Blob, and square symbols show data for the Pepper.\nBlack symbols denote data for stimuli with low diffuse reflectance; pink symbols denote stimuli\nwith high diffuse reflectance. Error bars show the standard error of the mean over two repetitions\nof the condition. Symbols with horizontal error bars indicate pairs where the stimulus under Grove\n(x axis) was the comparison and the stimulus under Kitchen (y axis) was the reference. Symbols\nwith the vertical error bars indicate the opposite case. The diagonal dashed line indicates unity; the\nhorizontal and vertical dashed lines indicate the reflectance parameter space of the display. (b) Points\nof subjective equality, lightness judgments, observer OCL. Plotting conventions are as in (a) with the\nexception that here the black and pink symbols indicate stimuli with low and high specular reflectance,\nrespectively. Corresponding plots for all observers for both light field changes are provided in the\nsupplementary materials (Figures S1\u00adS7).\nFigure 3b shows the effect of illumination geometry on perceived lightness for observer\nOCL. All data points lie above the diagonal, showing that for both shapes and both levels\nof specular reflectance the stimuli under the Kitchen light field had to have slightly higher\ndiffuse reflectance to perceptually match the stimuli under the Grove light field. Notably,\nthough, the effect of light field on perceived lightness was relatively small compared with\nthe effect on perceived glossiness, and similar for both shapes and both levels of specular\nreflectance. The smaller effects may arise from the fact that our manipulations of illumination\ngeometry were performed under conditions where the mean illuminant intensity was\napproximately equated (see Methods).\nFigure 4b summarizes the effects on lightness for all observers. Note that the scale on\nthe y-axis is expanded relative to Figure 4a. Again, the data were similar for all observers.\nThere was a small effect of illumination geometry on perceived lightness, but no interaction\nbetween light field and shape. Also, the effects did not depend strongly on stimulus specular\nreflectance, although there is a tendency for a larger effect for the higher level of specular\nreflectance. The data for the Grove/Galileo light field change are plotted in the same format\nas Figure 4b in the supplementary materials (Figure S8b). As with the glossiness judgments,\nthere was more observer variability for this light field change. Two observers, however,\nshowed clear effects of the light field on perceived lightness.\n3.2 Effects of shape\nWe found a large effect of shape on perceived glossiness when illumination geometry was\nkept constant. This is illustrated in Figure 5a for observer OCL. The data are shown in the\nBlob Pepper\nSlope of regression line\nGLA\n(a) Glossiness\nBlob Pepper\nSlope of regression line\nGLA\n(b) Lightness\nBlob Pepper\nVHY\nBlob Pepper\nVHY\nBlob Pepper\nOCL\nBlob Pepper\nOCL\nBlob Pepper\nCDI\nLow diffuse reflectance\nHigh diffuse reflectance\nBlob Pepper\nCDI\nLow specular reflectance\nHigh specular reflectance\nFigure 4. Effect of light field on perceived reflectance, Grove/Kitchen. (a) Each panel shows the slopes\nof regression lines fitted to PSE data for the glossiness judgments for one observer. Each set of bars\nin a panel shows the slopes for one shape. Slopes for low and high diffuse reflectance are shown in\nblack and pink, respectively. Error bars show the 67% confidence intervals of the regression line fit. (b)\nRegression slopes of the lightness judgments. Plotting conventions are as in (a) with the exception that\nhere the black and pink symbols indicate stimuli with low and high specular reflectance, respectively.\nsame format as in Figure 3, but here the axes are the specularities for the two shapes instead\nof for the two light fields. The data fall below or above the diagonal depending on the light\nfield, in other words, the effect of shape was opposite for the two light fields.\nFigure 6a shows the slopes for glossiness estimates across a shape change for all observers.\nThe two sets of bars in each panel show data for the two light fields. As in the light field\ncomparison, there was an interaction between the effect of light field and that of shape for\nall observers. In addition, for all observers except for VHY the results were similar for the two\nlevels of diffuse reflectance.\nThe effects of shape on perceived lightness, shown in Figure 5b for OCL and summarized\nin Figure 6b for all observers, were small, and there was not a large interaction between shape\nand light field.\nData for the Grove/Galileo light field change are shown in the supplementary materials\n(Figure S9). There was again a large effect of shape on perceived glossiness, with an\ninteraction shown by one of three observers. The effects on lightness were small relative to\nthe effects on glossiness.\nThe results from the change light field and change shape conditions show a strong interaction\nbetween object shape and illumination geometry for glossiness judgments. To probe this\ninteraction further, we ran a third condition where observers made glossiness and lightness\njudgments across joint changes in light field and shape. That is, we directly measured matches\nacross changes in both illuminant and shape (eg, Blob/Grove and Pepper/Kitchen).\nSlopes of the linear regression fits for the Grove/Kitchen comparison are shown in Figure 7.\nThe glossiness estimates were more variable across observers than in the single change\nconditions. The slopes for the two levels of diffuse reflectance were similar for three observers,\nJoint effects of illumination and shape 1023\nSpecular reflectance Blob\nSpecular reflectance Pepper\nDiffuse reflectance Blob\nDiffuse reflectance Pepper\nOCL\nOCL\n(a) (b)\nGrove, low \nd\nKitchen, low \nd\nKitchen, high \nd\nGrove, high \nd\nGrove, low \ns\nKitchen, low \ns\nKitchen, high \ns\nGrove, high \ns\nGlossiness Lightness\nFigure 5. Effect of shape on perceived reflectance, Grove/Kitchen. (a) Points of equal perceived\nglossiness across a change in shape for observer OCL. A given data point shows a pair of specularity\nvalues for two shapes that match in perceived glossiness. Diamonds show data for the Grove light field,\nand stars show data for the Kitchen light field. Black symbols denote data for stimuli with low diffuse\nreflectance; light red symbols denote stimuli with high diffuse reflectance. The error bars show the\nstandard error of the mean over two repetitions. Symbols with horizontal error bars indicate pairs\nwhere the Blob (x-axis) was the comparison and the Pepper (y-axis) was the reference. Symbols with\nvertical error bars indicate the opposite case. The diagonal dashed line indicates unity; the horizontal\nand vertical dashed lines indicate the reflectance parameter space of the display. (b) Points of equal\nperceived lightness for the shape comparison. Plotting conventions are as in (a) with the exception that\nhere the black and pink symbols indicate stimuli with low and high specular reflectance, respectively.\nCorresponding plots for all observers for both light field changes are provided in the supplementary\nmaterials (Figures S1\u00adS7).\nwhile the fourth observer (CDI) showed a clear difference between the two levels of diffuse\nreflectance. The data for the lightness estimates were less variable across observers and were\nqualitatively, if not quantitatively, similar for the two levels of specular reflectance. Data\nfor the Grove/Galileo light field change are shown in the supplementary materials (Figure\nS10), with large effects shown for perceived glossiness and smaller, less consistent effects for\nperceived lightness.\nOur first analysis of the joint measurements checked the consistency of the measurement\nprocedure by asking whether the measurements satisfied transitivity (see Doerschner, Boyaci\net al 2010). What we mean by this may be understood with reference to Figure 8a. The\nmeasurements for shape and illuminant changes alone are characterized by slopes. We\ndenote these effects by the red arrows in the figure. For example, the arrow labeled A indicates\nthe effect of changing the illuminant from Grove to Kitchen for the Blob shape. Since each\nof the effects we measure are reasonably described by a multiplicative scaling (slope of the\nfit regression lines), the slope obtained for a joint change (indicated in the figure by the\ndashed blue arrow for Blob/Grove to Pepper/Kitchen) should be predicted by the product of\nthe slopes obtained for the component changes. For the case illustrated by the figure, this\nproduct may be obtained from slopes for the two measurements indicated by the red arrows.\nWe compared predictions made in this way against the joint measurement for shape and\nilluminant changes.\nFigure 9 summarizes the results of the transitivity check for glossiness (left panel) and\nlightness (right panel). For most of the measurements, transitivity held well. In the figure,\nthe solid points are those where the prediction error for the slope of the joint measurement\nGrove Kitchen\nSlope of regression line\nGLA\n(a) Glossiness\nGrove Kitchen\nSlope of regression line\nGLA\n(b) Lightness\nGrove Kitchen\nVHY\nGrove Kitchen\nVHY\nGrove Kitchen\nOCL\nGrove Kitchen\nOCL\nGrove Kitchen\nCDI\nLow diffuse reflectance\nHigh diffuse reflectance\nGrove Kitchen\nCDI\nLow specular reflectance\nHigh specular reflectance\nFigure 6. Effect of shape on perceived reflectance, Grove/Kitchen. (a) Each panel shows the slopes\nof regression lines fitted to PSE data for the glossiness judgments for one observer. The two sets of\nbars in a panel show the slopes for the two light fields. Slopes for low and high diffuse reflectance are\nshown in black and pink, respectively. Error bars show the 67% confidence intervals of the line fit. (b)\nSlopes of linear regression lines fitted to the lightness PSE data for each observer. Plotting conventions\nare as in (a), with the exception that here the black and pink symbols indicate stimuli with low and\nhigh specular reflectance, respectively.\nobtained from both pairs of individual measurements was less than 0.8 for both glossiness\nand lightness. This criterion was chosen by eye. For the glossiness measurements, this\ncriterion was met for 47 out of 56 cases (84%, solid points). For lightness, all of the cases\nsatisfied the criterion. As we viewed transitivity of the data as a prerequisite for asking\nquestions about how well candidate models might predict joint effects, we restricted our\nsubsequent analysis of the joint effects to conditions corresponding to the solid points in\nFigure 9a.\nSince both illumination geometry and shape affect lightness and glossiness, understand-\ning these phenomena requires at minimum measurements of the effect of each variable\nwhen the other is held fixed. If the effects of the two variables do not interact, the joint effects\ncan be characterized by measurements of each alone at one fixed level of the other. This idea\nis illustrated by Figure 8b. Here the question becomes whether the joint effect illustrated by\nthe dashed blue line (E) is predicted by the product of the effects of the two red arrows, A\nand C. Note that when separability holds, the number of measurements required to jointly\ncharacterize effects of light field and shape increases linearly with the number of light fields\nand shapes studied, while in the general case, the number increases as the product of the two\nconditions. Thus if the data satisfy separability, the joint measurement enterprise is greatly\nsimplified.\nSeparability does not hold in general for the glossiness estimates for either of the light\nfield conditions (Grove/Kitchen and Grove/Galileo), as shown by Figure 9b (left panel; only\npredictions that met the transitivity criterion are plotted). The large failures shown are a\nconsequence of the interactions shown in Figures 4 and 6 above. The analysis here confirms\nthat such interactions are typical of the entire dataset.\nInterestingly, the predictions for glossiness span a much wider range of values than the\ndata. This indicates that for the stimuli employed here independence of the light field and\nJoint effects of illumination and shape 1025\nGrove/Blob Grove/Pepper\nSlope of regression line\nGLA\n(a) Glossiness\nGrove/Blob Grove/Pepper\nSlope of regression line\nGLA\n(b) Lightness\nGrove/Blob Grove/Pepper\nVHY\nGrove/Blob Grove/Pepper\nVHY\nGrove/Blob Grove/Pepper\nOCL\nGrove/Blob Grove/Pepper\nOCL\nGrove/Blob Grove/Pepper\nCDI\nLow diffuse reflectance\nHigh diffuse reflectance\nGrove/Blob Grove/Pepper\nCDI\nLow specular reflectance\nHigh specular reflectance\nFigure 7. Effect of a joint light field and shape change on perceived reflectance, Grove/Kitchen. (a)\nEach panel shows the slopes of regression lines fitted to the glossiness PSE data for each observer. Each\nset of bars shows the slopes for one shape/light field combination. Slopes for low and high diffuse\nreflectance are shown in black and pink, respectively. Error bars show the 67% confidence intervals\nof the line fit. (b) Slopes of linear regression lines fitted to the lightness PSE data for each observer.\nPlotting conventions are as in (a) with the exception that here the black and pink symbols indicate\nstimuli with low and high specular reflectance, respectively.\nshape effects would make the stimulus pairs in the joint condition to appear much more\ndifferent (shown with slopes deviating widely from unity) than how the observers perceived\nthem.\nSeparability holds better for the lightness estimates (Figure 9b, right panel), and indeed\nthe quality of the separability predictions is similar to that of the transitivity predictions.\n3.4 Image statistics\nOur results show that both illumination geometry and object shape can have a large effect\non perceived glossiness. In addition, the effect of a combined light field and shape change on\nglossiness cannot be easily predicted from the individual effects. Scrutinizing the stimulus\nimages in Figure 8 provides some intuition to why this is so: It is hard to describe the result\nof combining the two changes as an addition or a product of the changes seen for each\nmanipulation alone.\nSome authors have suggested that simple luminance histogram statistics predict per-\nceived reflectance and in particular perceived glossiness (Nishida and Shinya 1998; Mo-\nof such models. In addition, models based on luminance histogram statistics did not work\nwell in our hands when we tried to use them to account for effects of illumination geometry\non the perceived glossiness of spheres (Olkkonen and Brainard 2010). Nonetheless, it remains\nof topical interest to understand the role of luminance histogram statistics, particularly for\nthe perception of glossiness, and we thus asked how well our current data could be accounted\nfor with models that predict perceptual equivalence on the basis of equating such statistics.\nA\nB\nE\n(a)\nGrove Kitchen\nBlob\nPepper\nTransitivity analysis\nA\nE\n(b)\nGrove Kitchen\nBlob\nPepper\nSeparability analysis\nC\nFigure 8. (a) The transitivity of the effects of light field and shape on perceived reflectance can be\nunderstood as follows. The arrow labeled A shows changes from the Grove light field to the Kitchen light\nfield for the Blob shape, whereas the arrow labeled B shows changes from the Blob to the Pepper for\nthe Kitchen light field. If transitivity holds, the effect of changing from Grove/Blob to Kitchen/Pepper\n(arrow E) should be the combination of the two separate effects (arrow A x arrow B). Note that a second\ntransitivity prediction for arrow E may also be obtained by multiplying the slope obtained for the\nchange from Blob to Pepper under the Grove light field and with the slope for the change from Grove\nto Kitchen for the Pepper. (b) If separability holds, the joint change of light field and shape (arrow E)\nshould be a combination of changing the light field (arrow A) and changing the shape (arrow C) for the\nsame reference stimulus (arrow A x arrow C). Note that a second separability prediction for arrow E\nmay be obtained by multiplying the slope for the change for Blob to Pepper under the Kitchen light\nfield with the slope for the change from Grove to Kitchen for the Pepper.\nFirst, we calculated the statistics of the luminance histograms of the Blob and Pepper\nobjects, across changes in light field, shape, or both for stimuli of constant reflectance.\nThese calculations provide a useful benchmark, as they tell us the relation between the\nstatistics that we would expect for a visual system that exhibited perfect glossiness constancy.\nNext, we calculated the same statistics for stimuli that matched in perceived (but not\nphysical) reflectance. These stimuli matched in both perceived glossiness and perceived\nlightness. According to the image statistics hypothesis, perceptually important statistics\nshould match for these stimuli. We chose to analyze the standard deviation and skewness,\nbased on previous reports that considered perceived glossiness, and added a third statistic\nthat measured the number of bright pixels in the image (defined as those with more than five\ntimes the mean luminance of the whole stimulus).\nThe results of these analyses are shown in Figure 10a\u00adb. Figure 10a illustrates the\neffect of changing the light field, shape, or both light field and shape on the statistics\nof physically matching stimuli. Each data point shows a particular stimulus with fixed\nreflectance undergoing either a light field, shape, or a joint change. Figure 10b shows the\nstatistics across perceptually matching stimuli for all three change types. If observers are\nsensitive to a given statistic, we would expect the data points to fall considerably closer to\nthe diagonal than in Figure 10a. This was not the case.\nFigure 10c rules out a possible artifactual reason for the predictive failure of the luminance\nhistogram statistics: if the stimulus manipulations available to our subjects did not allow\nequating of a particular statistic, it would not be possible for the model to work. We thus used\nnumerical parameter search to find the best match for each experimental condition and\nJoint effects of illumination and shape 1027\nMeasured slopes\nPredicted slopes\nGlossiness\n(b)\nGrove/Kitchen\nGrove/Galileo\nMeasured slopes\nPredicted slopes\nLightness\nMeasured slopes\nPredicted slopes\nGlossiness\n(a) Grove/Kitchen\nGrove/Galileo\nMeasured slopes\nPredicted slopes\nLightness\nFigure 9. (a) Transitivity analysis for glossiness (left) and lightness (right). The x-axis in each panel\nshows the slopes fitted to the data in the joint change condition. Each data point is one slope\nfitted to the data of one observer for a given level of reference diffuse (glossiness estimates) or\nspecular (lightness estimates) reflectance. There were two separate predictions for each measurement,\ncorresponding to the two independent ways that transitivity predictions could be made (see caption\nof Figure 9). Black symbols show the data for the Grove/Kitchen comparison, and green symbols show\nthe data for the Grove/Galileo comparison. The data points adhering to our criterion for transitivity\nare shown with filled symbols, and the outliers are shown with open symbols (see text for details). The\ndiagonal dashed line shows unity. The solid lines denote slopes of 1 on each axis, and the quadrants\nalong the negative diagonal denote regions where the predictions and data go in different directions.\nNote that the two panels have different scales. (b) Separability analysis. The x-axes are the same as in\n(a). The y-axes show slopes predicted from a separability model (see text). As in (a), there were two\nindependent predictions for each point on the x-axis. Predictions are plotted only for measurements\nsatisfying transitivity (solid points in (a)). Other plotting conventions are as in (a).\nstatistic within our stimulus parameter space. The results are shown in Figure 10c. For most\ncases, perfect equation is possible. Open circles show cases where stimulus limitations\nprevented a match. In Figure 10a\u00adb only points corresponding to the closed circles in\nFigure 10c are plotted. It is clear that many prediction failures occur for stimuli where\nthe statistic under consideration could have been matched within our experiment.\nIt is possible that summary statistics fare badly as predictors for perceived reflectance\nbecause they are calculated over the whole image such that the spatial properties of\n(a)\nMatched stimulus statistic\nStandard deviation\nSkewness\nBright pixels\n(b)\nMatched stimulus statistic\nStandard deviation\nSkewness\nBright pixels\n(c)\nMatched stimulus statistic\nReference stimulus statistic\nStandard deviation\nReference stimulus statistic\nSkewness\nReference stimulus statistic\nBright pixels\nFigure 10. Analysis of luminance histogram statistics. (a) Each panel shows how changing the light\nfield, shape, or both light field and shape changes image statistics for stimuli of fixed reflectance. For\neach change, the reference statistic is plotted on the x-axis and the matched statistic on the y-axis. Data\nare plotted only for stimuli for which the statistics could be matched within our stimulus parameter\nspace. From left to right, the statistics analyzed are the standard deviation the luminance histogram,\nthe skewness of luminance histogram, and the number of bright pixels. (b) Each panel shows the\nstatistics for perceptually matching pairs across the three changes. Error bars show one standard error\nof the mean across two measurements of each data point. Data are plotted only for stimuli for which\nthe statistics could be matched within our stimulus parameter space. Other plotting conventions are\nas in (a). (c) Statistics for pairs of stimuli matched by an optimization algorithm. See text for details.\nThe closed symbols show data points where the difference between the optimized statistic and the\nstatistic of the reference stimulus is less than 10% of the maximum value that the statistic took on.\nOpen symbols show the remaining cases.\nthe highlights and their relationship to shading are not taken into account. To probe\nthis possibility, we analyzed the statistics in several additional ways: by selecting a few\ninformative subbands of the luminance channel, by selecting two regions of interest (ROI) on\npredominantly convex or concave parts of the object surfaces, and by extracting the specular\nimage and analyzing its statistics (Figure 11). The results are shown in the format of Figure 10\nin the supplementary materials (Figures S11\u00adS14), and lead to the same conclusion as the\nanalysis of the full luminance histogram. Perception was not determined by any of these\nstatistics.\nJoint effects of illumination and shape 1029\n(a) (b)\n(c)\nGrove Kitchen Galileo\nBlob, Kitchen\nGrove Kitchen Galileo\nGrove Kitchen Galileo\nBlob\nPepper\nPepper, Kitchen\nFigure 11. Image statistics analyses were run on different versions of the original images. (a) Two\nROIs in the stimulus images with different surface geometries were chosen for luminance histogram\nanalysis. The ROIs for the three light fields and the two shapes are shown to the right of the stimulus\nimages. (b) Stimulus images for the kitchen light field are shown bandpass filtered with three filters\ncentered on the spatial frequencies of 28, 64, and 128 cycles/stimulus. (c) The specular images (ie, the\ndifference images between the glossy and the matte basis images) are shown for the three light fields\nand the two shapes.\n3.5 Effect of stimulus movement\nIn an additional experiment with new observers, we tested whether stimulus movement\nwould aid in estimating surface reflectance in the face of changes in illumination or object\ngeometry, as Wendt et al (2010) have suggested. The results are presented in the Appendix\nand show a slight improvement in constancy when the stimulus is rotated.\n4 Discussion\n4.1 Transitivity and separability\nWe checked whether our data satisfied transitivity (see Doerschner, Boyaci et al 2010).\nThis property held well for lightness but less well for glossiness. Indeed, there were large\nviolations of transitivity for glossiness for some of our measurement conditions. We do\nnot know the cause of these violations. It is possible that they arise because measurement\nerror is amplified when two measured quantities are multiplied, as is done when making\nthe transitivity predictions. This explanation, however, would predict similar violations for\nglossiness and lightness and is thus not entirely satisfactory. It is possible that in making\npairwise comparisons, observers weight different image features differently depending on\nthe comparison, an effect which could produce transitivity violations. In any case, we used\nthe transitivity analysis to select only data points for which transitivity was satisfied in our\nanalysis of separability.\nFor glossiness estimates, separability did not hold. This means that extreme caution must\nbe used in generalizing results on the effect of object shape obtained under a single light field\nor results on the effect of illumination geometry obtained for a single shape. For perceived\nlightness, separability held reasonably well. It should be noted that in general the effects of\nillumination geometry and shape on lightness were not large, so that there was less room for\nviolations of separability to arise.\n4.2 Individual differences\nThere were some marked individual differences in how surface glossiness was perceived in\nsome of the experimental conditions, particularly for the Grove/Galileo comparison. We do\nnot know the cause of these differences. As with the transitivity failures, one possibility is that\ndifferent observers attended to different aspects of the stimuli when making their judgments.\nSome observers noted that the glossiness comparison task was difficult, an observation\nconsistent with this interpretation, at least if one takes it to mean that observers were not\nquite sure what aspect of the complex stimuli should be compared.\n4.3 Relationship to previous research\nThe effect of illumination geometry on perceived reflectance has been shown in several\nstudies for different types of stimuli, but always for fixed object geometry. Fleming et al\n(2003) showed that illumination geometry affected the perceived glossiness of spheres in\nconventional displays, and Doerschner, Boyaci et al (2010) extended the result by showing\nin binocularly viewed conventional displays that the effects were transitive across light\nfield changes. In addition, te Pas and Pont (2005) showed that changes in reflectance were\nconfused with changes in illumination geometry, especially for smooth rendered objects as\nopposed to objects with three-dimensional surface texture (see also Pont and te Pas 2006).\nOlkkonen and Brainard (2010) studied the perceived glossiness and lightness of spheres\nin HDR displays, showing large effects of complex illumination geometry on perceived\nglossiness. The present study extends the previous findings to more complex shapes in full-\ncolor, HDR scenes, suggesting that the failures of reflectance constancy found in previous\nstudies were not due to missing color or luminance information or to the use of simple\nshapes.\nThe effect of object shape on reflectance perception was first shown by Nishida and\nShinya (1998). They were able to account for their data on the assumption that observers\nwere basing their estimates about surface reflectance largely on the luminance histograms of\nthe images. More recently, Ho et al (2008) showed that surface mesotexture (\"bumpiness\")\naffects the perceived glossiness of a surface. In effect, mesotexture was confounded with\nsurface glossiness to some extent (see, also, Wijntjes and Pont 2010). An effect of surface\nJoint effects of illumination and shape 1031\ngeometry was also shown by Wendt et al (2010), who additionally found that surface rotation\nand binocular viewing decreased the perceptual effects of shape. Notably, illumination\ngeometry was held constant in all of these experiments. Vangorp et al (2007) studied the\neffect of object shape, rather than surface mesotexture, on perceived reflectance and showed\nthat reflectance estimation was difficult across shape changes, especially for objects with flat\ngeometry (such as tessellated spheres). Vangorp et al (2007) repeated the experiment with\nseveral different illumination conditions, but in any given pair the illumination geometry was\nheld constant. They did not focus on whether the effect of shape depended on illumination\ngeometry, but did note that ability to judge glossiness differed for one of their illuminant\nconditions. Our experiments confirmed the effects of object shape on perceived glossiness\nand showed a strong dependence of the effects on illumination geometry.\nTo our knowledge, ours is the first study to investigate the joint effects of object shape\nand illumination geometry on perceived reflectance.\n4.4 Luminance histogram statistics\nWe were not able to account for our data on the basis of any of the luminance histogram statis-\ntics we analyzed, nor with variants of these statistics computed from subband histograms,\nregions of interest, or the specular reflectance component. Indeed, observers appeared to\nbe performing closer to constancy than to matching on the basis of luminance histogram\nstatistics (see, also, Olkkonen and Brainard 2010). Following Anderson and Kim (2009), we\nspeculate that previous studies that have been successful in accounting for the data on\nthe basis of luminance histogram statistics have obtained this result because the stimulus\nmanipulations were not sufficiently rich to reveal the type of failures we find. Indeed, an\nimportant point emphasized by Beck and Prazdny (1981) and more recently by Anderson and\n2011) is that the perception of glossiness depends not only on the distribution of luminance\nvalues in the image but also on the spatial distribution of the luminances. In a seminal\ndemonstration, Beck and Prazdny (1981) showed that objects appear glossier if the highlights\nare oriented in the direction of minimum curvature on the surface. Rotation of the highlights\naway from this point decreased apparent gloss (see, also, Berzhanskaya et al 2005). Similar\neffects were shown by Anderson and Kim (2009) and Kim et al (2011) for objects with more\ncomplex surface structure. In our stimuli, the illumination and shape manipulations induced\nchanges in both the luminance histograms and the spatial relations between highlights and\nsurface relief.\nWe studied the effects of illumination geometry and object shape on perceived glossiness\nand lightness. In general, both manipulations affect both judgments. Of central importance,\nwe examined the joint effects of the two variables. For perceived glossiness, we found strong\ninteractions. The effect of a joint manipulation of both variables cannot be easily predicted\nfrom measurements of each alone. In addition, we examined a number of luminance\nhistogram statistics as possible predictors of the glossiness effects, and found that none\nexplained the data. Our results present a challenge for future research on perceived glossiness,\nas the enterprise of measuring the joint effects of illumination geometry and object shape\nwill not be tractable without the development of a theory that can account for the joint effects\nwithout requiring full factorial measurements. Our conclusion on perceived lightness is more\noptimistic. Although perceived lightness does vary with both object shape and illumination\ngeometry, we did not find large interactions between the two variables for the lightness\njudgment.\n"
}